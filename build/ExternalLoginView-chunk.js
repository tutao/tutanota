import "./dist-chunk.js";
import "./ProgrammingError-chunk.js";
import { assertMainOrNode } from "./Env-chunk.js";
import { client } from "./ClientDetector-chunk.js";
import { mithril_default } from "./mithril-chunk.js";
import { assertNotNull, base64ToUint8Array, base64UrlToBase64, noOp } from "./dist2-chunk.js";
import "./WhitelabelCustomizations-chunk.js";
import { lang } from "./LanguageViewModel-chunk.js";
import "./styles-chunk.js";
import "./theme-chunk.js";
import { KdfType, Keys, asKdfType } from "./TutanotaConstants-chunk.js";
import { keyManager } from "./KeyManager-chunk.js";
import "./WindowFacade-chunk.js";
import "./RootView-chunk.js";
import "./size-chunk.js";
import "./HtmlUtils-chunk.js";
import { GENERATED_MIN_ID } from "./EntityUtils-chunk.js";
import "./TypeModels-chunk.js";
import "./TypeRefs-chunk.js";
import "./CommonCalendarUtils-chunk.js";
import "./TypeModels2-chunk.js";
import "./TypeRefs2-chunk.js";
import "./ParserCombinator-chunk.js";
import "./FormatValidator-chunk.js";
import "./stream-chunk.js";
import "./Logger-chunk.js";
import "./ErrorHandler-chunk.js";
import "./EntityFunctions-chunk.js";
import "./TypeModels3-chunk.js";
import "./ModelInfo-chunk.js";
import "./ErrorUtils-chunk.js";
import { AccessExpiredError } from "./RestError-chunk.js";
import "./SetupMultipleError-chunk.js";
import "./OutOfSyncError-chunk.js";
import "./CancelledError-chunk.js";
import "./EventQueue-chunk.js";
import "./EntityRestClient-chunk.js";
import "./SuspensionError-chunk.js";
import "./LoginIncompleteError-chunk.js";
import "./CryptoError-chunk.js";
import "./RecipientsNotFoundError-chunk.js";
import "./DbError-chunk.js";
import "./QuotaExceededError-chunk.js";
import "./DeviceStorageUnavailableError-chunk.js";
import "./MailBodyTooLargeError-chunk.js";
import "./ImportError-chunk.js";
import "./WebauthnError-chunk.js";
import "./PermissionError-chunk.js";
import "./MessageDispatcher-chunk.js";
import "./WorkerProxy-chunk.js";
import "./EntityUpdateUtils-chunk.js";
import { SessionType } from "./SessionType-chunk.js";
import "./Services-chunk.js";
import "./EntityClient-chunk.js";
import "./dist3-chunk.js";
import "./PageContextLoginListener-chunk.js";
import "./CredentialType-chunk.js";
import "./CryptoWrapper-chunk.js";
import { ResumeSessionErrorReason } from "./LoginFacade-chunk.js";
import "./GroupUtils-chunk.js";
import "./Button-chunk.js";
import "./Icons-chunk.js";
import "./DialogHeaderBar-chunk.js";
import "./CountryList-chunk.js";
import { Autocomplete } from "./Dialog-chunk.js";
import { progressIcon } from "./Icon-chunk.js";
import "./AriaUtils-chunk.js";
import "./IconButton-chunk.js";
import "./Formatter-chunk.js";
import { locator } from "./CommonLocator-chunk.js";
import "./UserError-chunk.js";
import "./MailAddressParser-chunk.js";
import "./BlobUtils-chunk.js";
import "./FileUtils-chunk.js";
import { showProgressDialog } from "./ProgressDialog-chunk.js";
import "./SharedMailUtils-chunk.js";
import "./PasswordUtils-chunk.js";
import "./Recipient-chunk.js";
import "./SubscriptionDialogs-chunk.js";
import "./ExternalLink-chunk.js";
import "./ToggleButton-chunk.js";
import "./SnackBar-chunk.js";
import { credentialsToUnencrypted } from "./Credentials-chunk.js";
import "./NotificationOverlay-chunk.js";
import { Checkbox } from "./Checkbox-chunk.js";
import "./Expander-chunk.js";
import "./ClipboardUtils-chunk.js";
import "./Services4-chunk.js";
import "./BubbleButton-chunk.js";
import "./ErrorReporter-chunk.js";
import { PasswordField } from "./PasswordField-chunk.js";
import "./PasswordRequestDialog-chunk.js";
import "./ErrorHandlerImpl-chunk.js";
import { BaseTopLevelView, LoginScreenHeader } from "./LoginScreenHeader-chunk.js";
import { LoginButton } from "./LoginButton-chunk.js";
import { getLoginErrorMessage, handleExpectedLoginError, renderInfoLinks } from "./LoginUtils-chunk.js";
import { MessageBox } from "./MessageBox-chunk.js";

//#region src/mail-app/mail/view/ExternalLoginView.ts
assertMainOrNode();
var ExternalLoginViewModel = class {
	password = "";
	doSavePassword = false;
	helpText = "emptyString_msg";
	errorMessageId = null;
	autologinInProgress = false;
	showAutoLoginButton = false;
	_urlData = null;
	get urlData() {
		return assertNotNull(this._urlData);
	}
	constructor(credentialsProvider) {
		this.credentialsProvider = credentialsProvider;
	}
	formLogin() {
		if (this.password === "") this.helpText = "loginFailed_msg";
else {
			this.helpText = "login_msg";
			this.handleLoginPromise(showProgressDialog("login_msg", this.doFormLogin()), noOp);
		}
	}
	async doFormLogin() {
		const password = this.password;
		const clientIdentifier = client.browser + " " + client.device;
		const persistentSession = this.doSavePassword;
		const sessionType = persistentSession ? SessionType.Persistent : SessionType.Login;
		const { userId, salt, kdfType } = this.urlData;
		const newCredentials = await locator.logins.createExternalSession(userId, password, salt, kdfType, clientIdentifier, sessionType);
		this.password = "";
		const storedCredentials = await this.credentialsProvider.getDecryptedCredentialsByUserId(userId);
		if (persistentSession) await this.credentialsProvider.store(credentialsToUnencrypted(newCredentials, null));
		if (storedCredentials) {
			await locator.logins.deleteOldSession(storedCredentials);
			if (!persistentSession) await this.credentialsProvider.deleteByUserId(userId);
		}
	}
	async autologin(credentials) {
		this.autologinInProgress = true;
		await showProgressDialog("login_msg", this.handleLoginPromise(this.resumeSession(credentials), () => {
			this.autologinInProgress = false;
			mithril_default.redraw();
		}));
	}
	async resumeSession(credentials) {
		const result = await locator.logins.resumeSession(credentials, {
			salt: this.urlData.salt,
			kdfType: this.urlData.kdfType
		}, null);
		if (result.type === "error") switch (result.reason) {
			case ResumeSessionErrorReason.OfflineNotAvailableForFree: throw new Error("Cannot happen");
		}
	}
	async loginWithStoredCredentials() {
		try {
			const credentials = await this.credentialsProvider.getDecryptedCredentialsByUserId(this.urlData.userId);
			if (credentials) await this.autologin(credentials);
		} finally {
			this.showAutoLoginButton = false;
			mithril_default.redraw();
		}
	}
	async handleLoginPromise(loginPromise, errorAction) {
		try {
			await loginPromise;
			mithril_default.route.set(`/mail${location.hash}`);
			this.helpText = "emptyString_msg";
		} catch (e) {
			const messageId = getLoginErrorMessage(e, true);
			if (e instanceof AccessExpiredError) this.errorMessageId = messageId;
else this.helpText = messageId;
			mithril_default.redraw();
			handleExpectedLoginError(e, errorAction);
		}
	}
	async updateUrl(args) {
		try {
			const encodedExternalLoginData = decodeURIComponent(location.hash).substring(6);
			const userIdOffset = 0;
			const saltOffset = userIdOffset + GENERATED_MIN_ID.length;
			const encodedSaltLength = 22;
			const kdfOffset = saltOffset + encodedSaltLength;
			let kdfType = KdfType.Bcrypt;
			if (encodedExternalLoginData.length > kdfOffset) kdfType = asKdfType(encodedExternalLoginData.substring(kdfOffset, kdfOffset + 1));
			this._urlData = {
				userId: encodedExternalLoginData.substring(userIdOffset, saltOffset),
				salt: base64ToUint8Array(base64UrlToBase64(encodedExternalLoginData.substring(saltOffset, kdfOffset))),
				kdfType
			};
			const credentials = await this.credentialsProvider.getDecryptedCredentialsByUserId(this.urlData.userId);
			if (credentials && args.noAutoLogin !== true) await this.autologin(credentials);
else {
				this.showAutoLoginButton = credentials != null;
				mithril_default.redraw();
			}
		} catch (e) {
			this.errorMessageId = "invalidLink_msg";
			mithril_default.redraw();
		}
	}
	dispose() {
		this.password = "";
	}
};
var ExternalLoginView = class extends BaseTopLevelView {
	viewModel;
	shortcuts = [{
		key: Keys.RETURN,
		exec: () => {
			this.viewModel.formLogin();
		},
		help: "login_label"
	}];
	constructor(vnode) {
		super();
		this.viewModel = vnode.attrs.viewModelFactory();
	}
	oncreate() {
		keyManager.registerShortcuts(this.shortcuts);
	}
	onremove() {
		this.viewModel.password = "";
		this.viewModel.dispose();
		keyManager.unregisterShortcuts(this.shortcuts);
	}
	view({ attrs }) {
		return mithril_default(".main-view.flex.col.nav-bg", [mithril_default(LoginScreenHeader), mithril_default(".flex-grow.flex.col.items-center.scroll", mithril_default(".flex-grow-shrink-auto.flex.col.max-width-m.pt.pb.plr-l", this.renderContent()))]);
	}
	renderContent() {
		if (this.viewModel.autologinInProgress) return mithril_default("p.center", progressIcon());
else if (this.viewModel.errorMessageId) return mithril_default("p.center", mithril_default(MessageBox, {}, lang.getTranslationText(this.viewModel.errorMessageId)));
else return [
			mithril_default(".flex.col.content-bg.border-radius-big.plr-2l.mt", [this.viewModel.showAutoLoginButton ? this.renderAutoLoginButton() : this.renderForm(), mithril_default("p.center.statusTextColor.mt-xs.mb-s", mithril_default("small", lang.getTranslationText(this.viewModel.helpText), []))]),
			mithril_default(".flex-grow"),
			renderInfoLinks()
		];
	}
	renderAutoLoginButton() {
		return mithril_default(".pt-l", mithril_default(LoginButton, {
			label: "showMail_action",
			onclick: () => this.viewModel.loginWithStoredCredentials()
		}));
	}
	renderForm() {
		return [
			mithril_default(PasswordField, {
				helpLabel: () => lang.get("enterPresharedPassword_msg"),
				value: this.viewModel.password,
				autocompleteAs: Autocomplete.currentPassword,
				oninput: (input) => this.viewModel.password = input
			}),
			mithril_default(Checkbox, {
				label: () => lang.get("storePassword_action"),
				helpLabel: "onlyPrivateComputer_msg",
				checked: this.viewModel.doSavePassword,
				onChecked: (checked) => this.viewModel.doSavePassword = checked
			}),
			mithril_default(".pt", mithril_default(LoginButton, {
				label: "showMail_action",
				onclick: () => this.viewModel.formLogin()
			}))
		];
	}
	onNewUrl(args) {
		this.viewModel.updateUrl(args);
	}
};

//#endregion
export { ExternalLoginView, ExternalLoginViewModel };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiRXh0ZXJuYWxMb2dpblZpZXctY2h1bmsuanMiLCJuYW1lcyI6WyJjcmVkZW50aWFsc1Byb3ZpZGVyOiBDcmVkZW50aWFsc1Byb3ZpZGVyIiwiY3JlZGVudGlhbHM6IFVuZW5jcnlwdGVkQ3JlZGVudGlhbHMiLCJsb2dpblByb21pc2U6IFByb21pc2U8dm9pZD4iLCJlcnJvckFjdGlvbjogKCkgPT4gdm9pZCIsImFyZ3M6IFJlY29yZDxzdHJpbmcsIGFueT4iLCJ2bm9kZTogVm5vZGU8RXh0ZXJuYWxMb2dpblZpZXdBdHRycz4iXSwic291cmNlcyI6WyIuLi9zcmMvbWFpbC1hcHAvbWFpbC92aWV3L0V4dGVybmFsTG9naW5WaWV3LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBtLCB7IENoaWxkcmVuLCBWbm9kZSB9IGZyb20gXCJtaXRocmlsXCJcbmltcG9ydCB7IEFjY2Vzc0V4cGlyZWRFcnJvciB9IGZyb20gXCIuLi8uLi8uLi9jb21tb24vYXBpL2NvbW1vbi9lcnJvci9SZXN0RXJyb3IuanNcIlxuaW1wb3J0IHsgYXNzZXJ0Tm90TnVsbCwgYmFzZTY0VG9VaW50OEFycmF5LCBiYXNlNjRVcmxUb0Jhc2U2NCwgbm9PcCB9IGZyb20gXCJAdHV0YW8vdHV0YW5vdGEtdXRpbHNcIlxuaW1wb3J0IHR5cGUgeyBNYXliZVRyYW5zbGF0aW9uIH0gZnJvbSBcIi4uLy4uLy4uL2NvbW1vbi9taXNjL0xhbmd1YWdlVmlld01vZGVsLmpzXCJcbmltcG9ydCB7IGxhbmcgfSBmcm9tIFwiLi4vLi4vLi4vY29tbW9uL21pc2MvTGFuZ3VhZ2VWaWV3TW9kZWwuanNcIlxuaW1wb3J0IHsga2V5TWFuYWdlciwgU2hvcnRjdXQgfSBmcm9tIFwiLi4vLi4vLi4vY29tbW9uL21pc2MvS2V5TWFuYWdlci5qc1wiXG5pbXBvcnQgeyBjbGllbnQgfSBmcm9tIFwiLi4vLi4vLi4vY29tbW9uL21pc2MvQ2xpZW50RGV0ZWN0b3IuanNcIlxuaW1wb3J0IHsgc2hvd1Byb2dyZXNzRGlhbG9nIH0gZnJvbSBcIi4uLy4uLy4uL2NvbW1vbi9ndWkvZGlhbG9ncy9Qcm9ncmVzc0RpYWxvZy5qc1wiXG5pbXBvcnQgeyBhc0tkZlR5cGUsIEtkZlR5cGUsIEtleXMgfSBmcm9tIFwiLi4vLi4vLi4vY29tbW9uL2FwaS9jb21tb24vVHV0YW5vdGFDb25zdGFudHMuanNcIlxuaW1wb3J0IHsgcHJvZ3Jlc3NJY29uIH0gZnJvbSBcIi4uLy4uLy4uL2NvbW1vbi9ndWkvYmFzZS9JY29uLmpzXCJcbmltcG9ydCB7IEF1dG9jb21wbGV0ZSB9IGZyb20gXCIuLi8uLi8uLi9jb21tb24vZ3VpL2Jhc2UvVGV4dEZpZWxkLmpzXCJcbmltcG9ydCB7IENoZWNrYm94IH0gZnJvbSBcIi4uLy4uLy4uL2NvbW1vbi9ndWkvYmFzZS9DaGVja2JveC5qc1wiXG5pbXBvcnQgeyBNZXNzYWdlQm94IH0gZnJvbSBcIi4uLy4uLy4uL2NvbW1vbi9ndWkvYmFzZS9NZXNzYWdlQm94LmpzXCJcbmltcG9ydCB7IEdFTkVSQVRFRF9NSU5fSUQgfSBmcm9tIFwiLi4vLi4vLi4vY29tbW9uL2FwaS9jb21tb24vdXRpbHMvRW50aXR5VXRpbHMuanNcIlxuaW1wb3J0IHsgZ2V0TG9naW5FcnJvck1lc3NhZ2UsIGhhbmRsZUV4cGVjdGVkTG9naW5FcnJvciB9IGZyb20gXCIuLi8uLi8uLi9jb21tb24vbWlzYy9Mb2dpblV0aWxzLmpzXCJcbmltcG9ydCB0eXBlIHsgQ3JlZGVudGlhbHNQcm92aWRlciB9IGZyb20gXCIuLi8uLi8uLi9jb21tb24vbWlzYy9jcmVkZW50aWFscy9DcmVkZW50aWFsc1Byb3ZpZGVyLmpzXCJcbmltcG9ydCB7IGFzc2VydE1haW5Pck5vZGUgfSBmcm9tIFwiLi4vLi4vLi4vY29tbW9uL2FwaS9jb21tb24vRW52LmpzXCJcbmltcG9ydCB7IGNyZWRlbnRpYWxzVG9VbmVuY3J5cHRlZCB9IGZyb20gXCIuLi8uLi8uLi9jb21tb24vbWlzYy9jcmVkZW50aWFscy9DcmVkZW50aWFscy5qc1wiXG5pbXBvcnQgeyBTZXNzaW9uVHlwZSB9IGZyb20gXCIuLi8uLi8uLi9jb21tb24vYXBpL2NvbW1vbi9TZXNzaW9uVHlwZS5qc1wiXG5pbXBvcnQgeyBSZXN1bWVTZXNzaW9uRXJyb3JSZWFzb24gfSBmcm9tIFwiLi4vLi4vLi4vY29tbW9uL2FwaS93b3JrZXIvZmFjYWRlcy9Mb2dpbkZhY2FkZS5qc1wiXG5pbXBvcnQgeyBUb3BMZXZlbEF0dHJzLCBUb3BMZXZlbFZpZXcgfSBmcm9tIFwiLi4vLi4vLi4vVG9wTGV2ZWxWaWV3LmpzXCJcbmltcG9ydCB7IEJhc2VUb3BMZXZlbFZpZXcgfSBmcm9tIFwiLi4vLi4vLi4vY29tbW9uL2d1aS9CYXNlVG9wTGV2ZWxWaWV3LmpzXCJcbmltcG9ydCB7IGxvY2F0b3IgfSBmcm9tIFwiLi4vLi4vLi4vY29tbW9uL2FwaS9tYWluL0NvbW1vbkxvY2F0b3IuanNcIlxuaW1wb3J0IHsgTG9naW5TY3JlZW5IZWFkZXIgfSBmcm9tIFwiLi4vLi4vLi4vY29tbW9uL2d1aS9Mb2dpblNjcmVlbkhlYWRlci5qc1wiXG5pbXBvcnQgeyBMb2dpbkJ1dHRvbiB9IGZyb20gXCIuLi8uLi8uLi9jb21tb24vZ3VpL2Jhc2UvYnV0dG9ucy9Mb2dpbkJ1dHRvbi5qc1wiXG5pbXBvcnQgeyBVbmVuY3J5cHRlZENyZWRlbnRpYWxzIH0gZnJvbSBcIi4uLy4uLy4uL2NvbW1vbi9uYXRpdmUvY29tbW9uL2dlbmVyYXRlZGlwYy9VbmVuY3J5cHRlZENyZWRlbnRpYWxzLmpzXCJcbmltcG9ydCB7IFBhc3N3b3JkRmllbGQgfSBmcm9tIFwiLi4vLi4vLi4vY29tbW9uL21pc2MvcGFzc3dvcmRzL1Bhc3N3b3JkRmllbGQuanNcIlxuaW1wb3J0IHsgcmVuZGVySW5mb0xpbmtzIH0gZnJvbSBcIi4uLy4uLy4uL2NvbW1vbi9ndWkvUmVuZGVyTG9naW5JbmZvTGlua3MuanNcIlxuXG5hc3NlcnRNYWluT3JOb2RlKClcblxudHlwZSBVcmxEYXRhID0geyB1c2VySWQ6IElkOyBzYWx0OiBVaW50OEFycmF5OyBrZGZUeXBlOiBLZGZUeXBlIH1cblxuZXhwb3J0IGNsYXNzIEV4dGVybmFsTG9naW5WaWV3TW9kZWwge1xuXHRwYXNzd29yZDogc3RyaW5nID0gXCJcIlxuXHRkb1NhdmVQYXNzd29yZDogYm9vbGVhbiA9IGZhbHNlXG5cdGhlbHBUZXh0OiBNYXliZVRyYW5zbGF0aW9uID0gXCJlbXB0eVN0cmluZ19tc2dcIlxuXHRlcnJvck1lc3NhZ2VJZDogTWF5YmVUcmFuc2xhdGlvbiB8IG51bGwgPSBudWxsXG5cdGF1dG9sb2dpbkluUHJvZ3Jlc3MgPSBmYWxzZVxuXHRzaG93QXV0b0xvZ2luQnV0dG9uID0gZmFsc2VcblxuXHRwcml2YXRlIF91cmxEYXRhOiBVcmxEYXRhIHwgbnVsbCA9IG51bGxcblx0Z2V0IHVybERhdGEoKTogVXJsRGF0YSB7XG5cdFx0cmV0dXJuIGFzc2VydE5vdE51bGwodGhpcy5fdXJsRGF0YSlcblx0fVxuXG5cdGNvbnN0cnVjdG9yKHByaXZhdGUgcmVhZG9ubHkgY3JlZGVudGlhbHNQcm92aWRlcjogQ3JlZGVudGlhbHNQcm92aWRlcikge31cblxuXHRmb3JtTG9naW4oKSB7XG5cdFx0aWYgKHRoaXMucGFzc3dvcmQgPT09IFwiXCIpIHtcblx0XHRcdHRoaXMuaGVscFRleHQgPSBcImxvZ2luRmFpbGVkX21zZ1wiXG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuaGVscFRleHQgPSBcImxvZ2luX21zZ1wiXG5cdFx0XHR0aGlzLmhhbmRsZUxvZ2luUHJvbWlzZShzaG93UHJvZ3Jlc3NEaWFsb2coXCJsb2dpbl9tc2dcIiwgdGhpcy5kb0Zvcm1Mb2dpbigpKSwgbm9PcClcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIGFzeW5jIGRvRm9ybUxvZ2luKCkge1xuXHRcdGNvbnN0IHBhc3N3b3JkID0gdGhpcy5wYXNzd29yZFxuXHRcdGNvbnN0IGNsaWVudElkZW50aWZpZXIgPSBjbGllbnQuYnJvd3NlciArIFwiIFwiICsgY2xpZW50LmRldmljZVxuXHRcdGNvbnN0IHBlcnNpc3RlbnRTZXNzaW9uID0gdGhpcy5kb1NhdmVQYXNzd29yZFxuXG5cdFx0Y29uc3Qgc2Vzc2lvblR5cGUgPSBwZXJzaXN0ZW50U2Vzc2lvbiA/IFNlc3Npb25UeXBlLlBlcnNpc3RlbnQgOiBTZXNzaW9uVHlwZS5Mb2dpblxuXHRcdGNvbnN0IHsgdXNlcklkLCBzYWx0LCBrZGZUeXBlIH0gPSB0aGlzLnVybERhdGFcblx0XHRjb25zdCBuZXdDcmVkZW50aWFscyA9IGF3YWl0IGxvY2F0b3IubG9naW5zLmNyZWF0ZUV4dGVybmFsU2Vzc2lvbih1c2VySWQsIHBhc3N3b3JkLCBzYWx0LCBrZGZUeXBlLCBjbGllbnRJZGVudGlmaWVyLCBzZXNzaW9uVHlwZSlcblxuXHRcdHRoaXMucGFzc3dvcmQgPSBcIlwiXG5cblx0XHRjb25zdCBzdG9yZWRDcmVkZW50aWFscyA9IGF3YWl0IHRoaXMuY3JlZGVudGlhbHNQcm92aWRlci5nZXREZWNyeXB0ZWRDcmVkZW50aWFsc0J5VXNlcklkKHVzZXJJZClcblxuXHRcdC8vIEZvciBleHRlcm5hbCB1c2VycyB1c2VySWQgaXMgdXNlZCBpbnN0ZWFkIG9mIGVtYWlsIGFkZHJlc3Ncblx0XHRpZiAocGVyc2lzdGVudFNlc3Npb24pIHtcblx0XHRcdGF3YWl0IHRoaXMuY3JlZGVudGlhbHNQcm92aWRlci5zdG9yZShjcmVkZW50aWFsc1RvVW5lbmNyeXB0ZWQobmV3Q3JlZGVudGlhbHMsIG51bGwpKVxuXHRcdH1cblxuXHRcdGlmIChzdG9yZWRDcmVkZW50aWFscykge1xuXHRcdFx0Ly8gZGVsZXRlIHBlcnNpc3RlbnQgc2Vzc2lvbiBpZiBhIG5ldyBzZXNzaW9uIGlzIGNyZWF0ZWRcblx0XHRcdGF3YWl0IGxvY2F0b3IubG9naW5zLmRlbGV0ZU9sZFNlc3Npb24oc3RvcmVkQ3JlZGVudGlhbHMpXG5cblx0XHRcdGlmICghcGVyc2lzdGVudFNlc3Npb24pIHtcblx0XHRcdFx0YXdhaXQgdGhpcy5jcmVkZW50aWFsc1Byb3ZpZGVyLmRlbGV0ZUJ5VXNlcklkKHVzZXJJZClcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRhc3luYyBhdXRvbG9naW4oY3JlZGVudGlhbHM6IFVuZW5jcnlwdGVkQ3JlZGVudGlhbHMpIHtcblx0XHR0aGlzLmF1dG9sb2dpbkluUHJvZ3Jlc3MgPSB0cnVlXG5cdFx0YXdhaXQgc2hvd1Byb2dyZXNzRGlhbG9nKFxuXHRcdFx0XCJsb2dpbl9tc2dcIixcblx0XHRcdHRoaXMuaGFuZGxlTG9naW5Qcm9taXNlKHRoaXMucmVzdW1lU2Vzc2lvbihjcmVkZW50aWFscyksICgpID0+IHtcblx0XHRcdFx0dGhpcy5hdXRvbG9naW5JblByb2dyZXNzID0gZmFsc2Vcblx0XHRcdFx0bS5yZWRyYXcoKVxuXHRcdFx0fSksXG5cdFx0KVxuXHR9XG5cblx0cHJpdmF0ZSBhc3luYyByZXN1bWVTZXNzaW9uKGNyZWRlbnRpYWxzOiBVbmVuY3J5cHRlZENyZWRlbnRpYWxzKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0Y29uc3QgcmVzdWx0ID0gYXdhaXQgbG9jYXRvci5sb2dpbnMucmVzdW1lU2Vzc2lvbihjcmVkZW50aWFscywgeyBzYWx0OiB0aGlzLnVybERhdGEuc2FsdCwga2RmVHlwZTogdGhpcy51cmxEYXRhLmtkZlR5cGUgfSwgbnVsbClcblx0XHRpZiAocmVzdWx0LnR5cGUgPT09IFwiZXJyb3JcIikge1xuXHRcdFx0c3dpdGNoIChyZXN1bHQucmVhc29uKSB7XG5cdFx0XHRcdGNhc2UgUmVzdW1lU2Vzc2lvbkVycm9yUmVhc29uLk9mZmxpbmVOb3RBdmFpbGFibGVGb3JGcmVlOlxuXHRcdFx0XHRcdHRocm93IG5ldyBFcnJvcihcIkNhbm5vdCBoYXBwZW5cIilcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRhc3luYyBsb2dpbldpdGhTdG9yZWRDcmVkZW50aWFscygpIHtcblx0XHR0cnkge1xuXHRcdFx0Y29uc3QgY3JlZGVudGlhbHMgPSBhd2FpdCB0aGlzLmNyZWRlbnRpYWxzUHJvdmlkZXIuZ2V0RGVjcnlwdGVkQ3JlZGVudGlhbHNCeVVzZXJJZCh0aGlzLnVybERhdGEudXNlcklkKVxuXHRcdFx0aWYgKGNyZWRlbnRpYWxzKSB7XG5cdFx0XHRcdGF3YWl0IHRoaXMuYXV0b2xvZ2luKGNyZWRlbnRpYWxzKVxuXHRcdFx0fVxuXHRcdH0gZmluYWxseSB7XG5cdFx0XHQvLyBpbiBjYXNlIHRoZXJlIGlzIGFuIGVycm9yIG9yIHRoZXJlIGFyZSBubyBjcmVkZW50aWFscyB3ZSBzaG91bGQgc2hvdyB0aGUgZm9ybVxuXHRcdFx0dGhpcy5zaG93QXV0b0xvZ2luQnV0dG9uID0gZmFsc2Vcblx0XHRcdG0ucmVkcmF3KClcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIGFzeW5jIGhhbmRsZUxvZ2luUHJvbWlzZShsb2dpblByb21pc2U6IFByb21pc2U8dm9pZD4sIGVycm9yQWN0aW9uOiAoKSA9PiB2b2lkKSB7XG5cdFx0dHJ5IHtcblx0XHRcdGF3YWl0IGxvZ2luUHJvbWlzZVxuXHRcdFx0bS5yb3V0ZS5zZXQoYC9tYWlsJHtsb2NhdGlvbi5oYXNofWApXG5cdFx0XHR0aGlzLmhlbHBUZXh0ID0gXCJlbXB0eVN0cmluZ19tc2dcIlxuXHRcdH0gY2F0Y2ggKGUpIHtcblx0XHRcdGNvbnN0IG1lc3NhZ2VJZCA9IGdldExvZ2luRXJyb3JNZXNzYWdlKGUsIHRydWUpXG5cblx0XHRcdGlmIChlIGluc3RhbmNlb2YgQWNjZXNzRXhwaXJlZEVycm9yKSB7XG5cdFx0XHRcdHRoaXMuZXJyb3JNZXNzYWdlSWQgPSBtZXNzYWdlSWRcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHRoaXMuaGVscFRleHQgPSBtZXNzYWdlSWRcblx0XHRcdH1cblxuXHRcdFx0bS5yZWRyYXcoKVxuXG5cdFx0XHRoYW5kbGVFeHBlY3RlZExvZ2luRXJyb3IoZSwgZXJyb3JBY3Rpb24pXG5cdFx0fVxuXHR9XG5cblx0YXN5bmMgdXBkYXRlVXJsKGFyZ3M6IFJlY29yZDxzdHJpbmcsIGFueT4pOiBQcm9taXNlPHZvaWQ+IHtcblx0XHR0cnkge1xuXHRcdFx0Y29uc3QgZW5jb2RlZEV4dGVybmFsTG9naW5EYXRhID0gZGVjb2RlVVJJQ29tcG9uZW50KGxvY2F0aW9uLmhhc2gpLnN1YnN0cmluZyg2KSAvLyBjdXRvZmYgI21haWwvIGZyb20gI21haWwvS2R1enJnRi0tLS0wUzNCVE8yZ3lwZkRNa2V0V0JfUGJxUVxuXG5cdFx0XHRjb25zdCB1c2VySWRPZmZzZXQgPSAwXG5cdFx0XHRjb25zdCBzYWx0T2Zmc2V0ID0gdXNlcklkT2Zmc2V0ICsgR0VORVJBVEVEX01JTl9JRC5sZW5ndGhcblx0XHRcdC8vIDE2IGJ5dGVzIEJhc2U2NCBlbmNvZGVkIGlzIGNlaWwoMTYgKiA0LzMpIGJ5dGVzLCBvciAyMiBieXRlc1xuXHRcdFx0Y29uc3QgZW5jb2RlZFNhbHRMZW5ndGggPSAyMlxuXHRcdFx0Y29uc3Qga2RmT2Zmc2V0ID0gc2FsdE9mZnNldCArIGVuY29kZWRTYWx0TGVuZ3RoXG5cblx0XHRcdC8vIGNoZWNrIGlmIHRoZSBLREYgdHlwZSBpcyBpbiB0aGUgVVJMIChlbmNvZGVkRXh0ZXJuYWxMb2dpbkRhdGEubGVuZ3RoID4ga2RmT2Zmc2V0KTsgaWYgbm90LCB3ZSBhc3N1bWUgYmNyeXB0IHRvIGVuc3VyZSBvbGQgbGlua3Mgc3RheSB2YWxpZFxuXHRcdFx0bGV0IGtkZlR5cGUgPSBLZGZUeXBlLkJjcnlwdFxuXHRcdFx0aWYgKGVuY29kZWRFeHRlcm5hbExvZ2luRGF0YS5sZW5ndGggPiBrZGZPZmZzZXQpIHtcblx0XHRcdFx0a2RmVHlwZSA9IGFzS2RmVHlwZShlbmNvZGVkRXh0ZXJuYWxMb2dpbkRhdGEuc3Vic3RyaW5nKGtkZk9mZnNldCwga2RmT2Zmc2V0ICsgMSkpXG5cdFx0XHR9XG5cblx0XHRcdHRoaXMuX3VybERhdGEgPSB7XG5cdFx0XHRcdHVzZXJJZDogZW5jb2RlZEV4dGVybmFsTG9naW5EYXRhLnN1YnN0cmluZyh1c2VySWRPZmZzZXQsIHNhbHRPZmZzZXQpLFxuXHRcdFx0XHRzYWx0OiBiYXNlNjRUb1VpbnQ4QXJyYXkoYmFzZTY0VXJsVG9CYXNlNjQoZW5jb2RlZEV4dGVybmFsTG9naW5EYXRhLnN1YnN0cmluZyhzYWx0T2Zmc2V0LCBrZGZPZmZzZXQpKSksXG5cdFx0XHRcdGtkZlR5cGU6IGtkZlR5cGUsXG5cdFx0XHR9XG5cblx0XHRcdGNvbnN0IGNyZWRlbnRpYWxzID0gYXdhaXQgdGhpcy5jcmVkZW50aWFsc1Byb3ZpZGVyLmdldERlY3J5cHRlZENyZWRlbnRpYWxzQnlVc2VySWQodGhpcy51cmxEYXRhLnVzZXJJZClcblxuXHRcdFx0aWYgKGNyZWRlbnRpYWxzICYmIGFyZ3Mubm9BdXRvTG9naW4gIT09IHRydWUpIHtcblx0XHRcdFx0YXdhaXQgdGhpcy5hdXRvbG9naW4oY3JlZGVudGlhbHMpXG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0aGlzLnNob3dBdXRvTG9naW5CdXR0b24gPSBjcmVkZW50aWFscyAhPSBudWxsXG5cdFx0XHRcdG0ucmVkcmF3KClcblx0XHRcdH1cblx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHR0aGlzLmVycm9yTWVzc2FnZUlkID0gXCJpbnZhbGlkTGlua19tc2dcIlxuXHRcdFx0bS5yZWRyYXcoKVxuXHRcdH1cblx0fVxuXG5cdGRpc3Bvc2UoKSB7XG5cdFx0dGhpcy5wYXNzd29yZCA9IFwiXCJcblx0fVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEV4dGVybmFsTG9naW5WaWV3QXR0cnMgZXh0ZW5kcyBUb3BMZXZlbEF0dHJzIHtcblx0dmlld01vZGVsRmFjdG9yeTogKCkgPT4gRXh0ZXJuYWxMb2dpblZpZXdNb2RlbFxufVxuXG4vKiogTG9naW4gdmlldyBmb3IgZXh0ZXJuYWwgbWFpbGJveGVzOiByZWNpcGllbnRzIGZyb20gb3RoZXIgbWFpbCBzZXJ2ZXJzIHdoZW4gdGhlIGVtYWlsIGlzIHBhc3N3b3JkLXByb3RlY3RlZC4gKi9cbmV4cG9ydCBjbGFzcyBFeHRlcm5hbExvZ2luVmlldyBleHRlbmRzIEJhc2VUb3BMZXZlbFZpZXcgaW1wbGVtZW50cyBUb3BMZXZlbFZpZXc8RXh0ZXJuYWxMb2dpblZpZXdBdHRycz4ge1xuXHRwcml2YXRlIHJlYWRvbmx5IHZpZXdNb2RlbDogRXh0ZXJuYWxMb2dpblZpZXdNb2RlbFxuXHRwcml2YXRlIHJlYWRvbmx5IHNob3J0Y3V0czogQXJyYXk8U2hvcnRjdXQ+ID0gW1xuXHRcdHtcblx0XHRcdGtleTogS2V5cy5SRVRVUk4sXG5cdFx0XHRleGVjOiAoKSA9PiB7XG5cdFx0XHRcdHRoaXMudmlld01vZGVsLmZvcm1Mb2dpbigpXG5cdFx0XHR9LFxuXHRcdFx0aGVscDogXCJsb2dpbl9sYWJlbFwiLFxuXHRcdH0sXG5cdF1cblxuXHRjb25zdHJ1Y3Rvcih2bm9kZTogVm5vZGU8RXh0ZXJuYWxMb2dpblZpZXdBdHRycz4pIHtcblx0XHRzdXBlcigpXG5cdFx0dGhpcy52aWV3TW9kZWwgPSB2bm9kZS5hdHRycy52aWV3TW9kZWxGYWN0b3J5KClcblx0fVxuXG5cdG9uY3JlYXRlKCkge1xuXHRcdGtleU1hbmFnZXIucmVnaXN0ZXJTaG9ydGN1dHModGhpcy5zaG9ydGN1dHMpXG5cdH1cblxuXHRvbnJlbW92ZSgpIHtcblx0XHR0aGlzLnZpZXdNb2RlbC5wYXNzd29yZCA9IFwiXCJcblx0XHR0aGlzLnZpZXdNb2RlbC5kaXNwb3NlKClcblx0XHRrZXlNYW5hZ2VyLnVucmVnaXN0ZXJTaG9ydGN1dHModGhpcy5zaG9ydGN1dHMpXG5cdH1cblxuXHR2aWV3KHsgYXR0cnMgfTogVm5vZGU8RXh0ZXJuYWxMb2dpblZpZXdBdHRycz4pOiBDaGlsZHJlbiB7XG5cdFx0cmV0dXJuIG0oXCIubWFpbi12aWV3LmZsZXguY29sLm5hdi1iZ1wiLCBbXG5cdFx0XHRtKExvZ2luU2NyZWVuSGVhZGVyKSxcblx0XHRcdG0oXCIuZmxleC1ncm93LmZsZXguY29sLml0ZW1zLWNlbnRlci5zY3JvbGxcIiwgbShcIi5mbGV4LWdyb3ctc2hyaW5rLWF1dG8uZmxleC5jb2wubWF4LXdpZHRoLW0ucHQucGIucGxyLWxcIiwgdGhpcy5yZW5kZXJDb250ZW50KCkpKSxcblx0XHRdKVxuXHR9XG5cblx0cHJpdmF0ZSByZW5kZXJDb250ZW50KCk6IENoaWxkcmVuIHtcblx0XHRpZiAodGhpcy52aWV3TW9kZWwuYXV0b2xvZ2luSW5Qcm9ncmVzcykge1xuXHRcdFx0cmV0dXJuIG0oXCJwLmNlbnRlclwiLCBwcm9ncmVzc0ljb24oKSlcblx0XHR9IGVsc2UgaWYgKHRoaXMudmlld01vZGVsLmVycm9yTWVzc2FnZUlkKSB7XG5cdFx0XHRyZXR1cm4gbShcInAuY2VudGVyXCIsIG0oTWVzc2FnZUJveCwge30sIGxhbmcuZ2V0VHJhbnNsYXRpb25UZXh0KHRoaXMudmlld01vZGVsLmVycm9yTWVzc2FnZUlkKSkpXG5cdFx0fSBlbHNlIHtcblx0XHRcdHJldHVybiBbXG5cdFx0XHRcdG0oXCIuZmxleC5jb2wuY29udGVudC1iZy5ib3JkZXItcmFkaXVzLWJpZy5wbHItMmwubXRcIiwgW1xuXHRcdFx0XHRcdHRoaXMudmlld01vZGVsLnNob3dBdXRvTG9naW5CdXR0b24gPyB0aGlzLnJlbmRlckF1dG9Mb2dpbkJ1dHRvbigpIDogdGhpcy5yZW5kZXJGb3JtKCksXG5cdFx0XHRcdFx0bShcInAuY2VudGVyLnN0YXR1c1RleHRDb2xvci5tdC14cy5tYi1zXCIsIG0oXCJzbWFsbFwiLCBsYW5nLmdldFRyYW5zbGF0aW9uVGV4dCh0aGlzLnZpZXdNb2RlbC5oZWxwVGV4dCksIFtdKSksXG5cdFx0XHRcdF0pLFxuXHRcdFx0XHRtKFwiLmZsZXgtZ3Jvd1wiKSxcblx0XHRcdFx0cmVuZGVySW5mb0xpbmtzKCksXG5cdFx0XHRdXG5cdFx0fVxuXHR9XG5cblx0cmVuZGVyQXV0b0xvZ2luQnV0dG9uKCk6IENoaWxkcmVuIHtcblx0XHRyZXR1cm4gbShcblx0XHRcdFwiLnB0LWxcIixcblx0XHRcdG0oTG9naW5CdXR0b24sIHtcblx0XHRcdFx0bGFiZWw6IFwic2hvd01haWxfYWN0aW9uXCIsXG5cdFx0XHRcdG9uY2xpY2s6ICgpID0+IHRoaXMudmlld01vZGVsLmxvZ2luV2l0aFN0b3JlZENyZWRlbnRpYWxzKCksXG5cdFx0XHR9KSxcblx0XHQpXG5cdH1cblxuXHRyZW5kZXJGb3JtKCk6IENoaWxkcmVuIHtcblx0XHRyZXR1cm4gW1xuXHRcdFx0bShQYXNzd29yZEZpZWxkLCB7XG5cdFx0XHRcdGhlbHBMYWJlbDogKCkgPT4gbGFuZy5nZXQoXCJlbnRlclByZXNoYXJlZFBhc3N3b3JkX21zZ1wiKSxcblx0XHRcdFx0dmFsdWU6IHRoaXMudmlld01vZGVsLnBhc3N3b3JkLFxuXHRcdFx0XHRhdXRvY29tcGxldGVBczogQXV0b2NvbXBsZXRlLmN1cnJlbnRQYXNzd29yZCxcblx0XHRcdFx0b25pbnB1dDogKGlucHV0KSA9PiAodGhpcy52aWV3TW9kZWwucGFzc3dvcmQgPSBpbnB1dCksXG5cdFx0XHR9KSxcblx0XHRcdG0oQ2hlY2tib3gsIHtcblx0XHRcdFx0bGFiZWw6ICgpID0+IGxhbmcuZ2V0KFwic3RvcmVQYXNzd29yZF9hY3Rpb25cIiksXG5cdFx0XHRcdGhlbHBMYWJlbDogXCJvbmx5UHJpdmF0ZUNvbXB1dGVyX21zZ1wiLFxuXHRcdFx0XHRjaGVja2VkOiB0aGlzLnZpZXdNb2RlbC5kb1NhdmVQYXNzd29yZCxcblx0XHRcdFx0b25DaGVja2VkOiAoY2hlY2tlZCkgPT4gKHRoaXMudmlld01vZGVsLmRvU2F2ZVBhc3N3b3JkID0gY2hlY2tlZCksXG5cdFx0XHR9KSxcblx0XHRcdG0oXG5cdFx0XHRcdFwiLnB0XCIsXG5cdFx0XHRcdG0oTG9naW5CdXR0b24sIHtcblx0XHRcdFx0XHRsYWJlbDogXCJzaG93TWFpbF9hY3Rpb25cIixcblx0XHRcdFx0XHRvbmNsaWNrOiAoKSA9PiB0aGlzLnZpZXdNb2RlbC5mb3JtTG9naW4oKSxcblx0XHRcdFx0fSksXG5cdFx0XHQpLFxuXHRcdF1cblx0fVxuXG5cdG9uTmV3VXJsKGFyZ3M6IFJlY29yZDxzdHJpbmcsIGFueT4pIHtcblx0XHR0aGlzLnZpZXdNb2RlbC51cGRhdGVVcmwoYXJncylcblx0fVxufVxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7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