import { __toESM } from "./chunk-chunk.js";
import "./dist-chunk.js";
import "./ProgrammingError-chunk.js";
import "./Env-chunk.js";
import "./ClientDetector-chunk.js";
import "./mithril-chunk.js";
import { arrayEquals, debounce, lazyMemoized, memoized } from "./dist2-chunk.js";
import "./WhitelabelCustomizations-chunk.js";
import "./LanguageViewModel-chunk.js";
import "./styles-chunk.js";
import "./theme-chunk.js";
import "./TutanotaConstants-chunk.js";
import "./KeyManager-chunk.js";
import "./WindowFacade-chunk.js";
import "./size-chunk.js";
import "./HtmlUtils-chunk.js";
import "./luxon-chunk.js";
import { getEtId, isSameId } from "./EntityUtils-chunk.js";
import "./TypeModels-chunk.js";
import { ContactListEntryTypeRef, ContactListGroupRootTypeRef, ContactTypeRef, createContactListEntry } from "./TypeRefs-chunk.js";
import "./CommonCalendarUtils-chunk.js";
import "./TypeModels2-chunk.js";
import "./TypeRefs2-chunk.js";
import "./ParserCombinator-chunk.js";
import "./CalendarUtils-chunk.js";
import "./ImportExportUtils-chunk.js";
import "./FormatValidator-chunk.js";
import { require_stream } from "./stream-chunk.js";
import { ListAutoSelectBehavior } from "./DeviceConfig-chunk.js";
import "./ErrorUtils-chunk.js";
import "./RestError-chunk.js";
import "./OutOfSyncError-chunk.js";
import "./CancelledError-chunk.js";
import "./SuspensionError-chunk.js";
import "./LoginIncompleteError-chunk.js";
import "./CryptoError-chunk.js";
import "./RecipientsNotFoundError-chunk.js";
import "./DbError-chunk.js";
import "./QuotaExceededError-chunk.js";
import "./DeviceStorageUnavailableError-chunk.js";
import "./MailBodyTooLargeError-chunk.js";
import "./ImportError-chunk.js";
import "./WebauthnError-chunk.js";
import "./PermissionError-chunk.js";
import { isUpdateForTypeRef } from "./EntityUpdateUtils-chunk.js";
import "./Button-chunk.js";
import "./Icon-chunk.js";
import { locator } from "./CommonLocator-chunk.js";
import "./List-chunk.js";
import "./ListModel-chunk.js";
import { ListElementListModel } from "./ListElementListModel-chunk.js";

//#region src/mail-app/contacts/view/ContactListViewModel.ts
var import_stream = __toESM(require_stream(), 1);
var ContactListViewModel = class {
	selectedContactList = null;
	contactsForSelectedEntry = [];
	listModelStateStream = null;
	sortedContactListInfos = (0, import_stream.default)([]);
	sortedSharedContactListInfos = (0, import_stream.default)([]);
	constructor(entityClient, groupManagementFacade, loginController, eventController, contactModel, contactListInvitations, router, updateUi) {
		this.entityClient = entityClient;
		this.groupManagementFacade = groupManagementFacade;
		this.loginController = loginController;
		this.eventController = eventController;
		this.contactModel = contactModel;
		this.contactListInvitations = contactListInvitations;
		this.router = router;
		this.updateUi = updateUi;
	}
	async showListAndEntry(listId, entryId) {
		this.selectedContactList = listId ?? null;
		await this.init();
		if (this.selectedContactList === listId && !this.getContactListInfoForEntryListId(listId)) this.selectedContactList = null;
		await this.listModel?.loadInitial();
		if (listId && entryId) this.loadAndSelect(listId, entryId);
	}
	init = lazyMemoized(async () => {
		this.eventController.addEntityListener(this.entityEventsReceived);
		this.sortedContactListInfos = this.contactModel.getOwnContactListInfos().map((infos) => {
			this.updateUi();
			return infos.slice().sort((a, b) => a.name.localeCompare(b.name));
		});
		this.sortedSharedContactListInfos = this.contactModel.getSharedContactListInfos().map((infos) => {
			this.updateUi();
			return infos.slice().sort((a, b) => a.name.localeCompare(b.name));
		});
		this.contactListInvitations.init();
		this.contactListInvitations.invitations.map(this.updateUi);
		await this.contactModel.getLoadedContactListInfos();
	});
	get listModel() {
		return this.selectedContactList ? this._listModel(this.selectedContactList) : null;
	}
	_listModel = memoized((listId) => {
		const newListModel = new ListElementListModel({
			fetch: async () => {
				const items = await this.getRecipientsForList(listId);
				return {
					items,
					complete: true
				};
			},
			loadSingle: async (_listId, elementId) => {
				return this.entityClient.load(ContactListEntryTypeRef, [listId, elementId]);
			},
			sortCompare: (rl1, rl2) => rl1.emailAddress.localeCompare(rl2.emailAddress),
			autoSelectBehavior: () => ListAutoSelectBehavior.OLDER
		});
		this.listModelStateStream?.end(true);
		this.listModelStateStream = newListModel.stateStream.map(() => {
			this.contactsForSelectedEntry = [];
			this.updateUi();
			this.updateUrl();
			this.getContactsForSelectedContactListEntry();
		});
		return newListModel;
	});
	async loadAndSelect(listId, contactListEntryId) {
		await this.listModel?.loadAndSelect(contactListEntryId, () => this.selectedContactList !== listId);
	}
	getContactListId() {
		return this.contactModel.getContactListId();
	}
	getOwnContactListInfos() {
		return this.sortedContactListInfos() ?? [];
	}
	getSharedContactListInfos() {
		return this.sortedSharedContactListInfos() ?? [];
	}
	getContactListInvitations() {
		return this.contactListInvitations.invitations();
	}
	getContactsForSelectedContactListEntry = debounce(50, async () => {
		const selected = this.getSelectedContactListEntries();
		if (selected?.length === 1) {
			const searchedContacts = await this.contactModel.searchForContacts(selected[0].emailAddress, "mailAddress", 10);
			const contacts = searchedContacts.filter((contact) => contact.mailAddresses.map((mailAddress) => mailAddress.address).includes(selected[0].emailAddress));
			const nowSelected = this.getSelectedContactListEntries() ?? [];
			if (arrayEquals(selected, nowSelected)) this.contactsForSelectedEntry = contacts;
		} else return [];
		this.updateUi();
	});
	updateUrl() {
		if (!this.listModel?.state.inMultiselect) {
			const recipient = this.getSelectedContactListEntries();
			if (recipient && recipient.length === 1) {
				this.router.routeTo(`/contactlist/:listId/:itemId`, {
					listId: this.selectedContactList,
					itemId: recipient[0]._id[1]
				});
				return;
			}
		}
		if (this.selectedContactList) this.router.routeTo(`/contactlist/:listId`, { listId: this.selectedContactList });
else this.router.routeTo(`/contactlist`, {});
	}
	async canCreateContactList() {
		const planConfig = await this.loginController.getUserController().getPlanConfig();
		return planConfig.contactList;
	}
	async addContactList(name, recipients) {
		const newGroup = await this.groupManagementFacade.createContactListGroup(name);
		const newContactList = await this.entityClient.load(ContactListGroupRootTypeRef, newGroup._id);
		this.addRecipientstoContactList(recipients, newContactList);
	}
	async addRecipientstoContactList(addresses, contactListGroupRoot) {
		const currentRecipients = await this.getRecipientsForList(contactListGroupRoot.entries);
		const listAddresses = currentRecipients.map((entry) => entry.emailAddress);
		for (const address of addresses) if (!listAddresses.includes(address)) {
			const recipient = createContactListEntry({
				_ownerGroup: contactListGroupRoot._id,
				emailAddress: address
			});
			this.addEntryOnList(contactListGroupRoot.entries, recipient);
		}
	}
	addEntryOnList(recipientsId, recipient) {
		this.entityClient.setup(recipientsId, recipient);
	}
	entityEventsReceived = async (updates) => {
		for (const update of updates) {
			if (this.selectedContactList) {
				const { instanceListId, instanceId, operation } = update;
				if (isUpdateForTypeRef(ContactListEntryTypeRef, update) && isSameId(this.selectedContactList, instanceListId)) await this.listModel?.entityEventReceived(instanceListId, instanceId, operation);
else if (isUpdateForTypeRef(ContactTypeRef, update)) this.getContactsForSelectedContactListEntry();
			}
			this.updateUi();
		}
	};
	updateSelectedContactList(selected) {
		this.selectedContactList = selected;
		this.listModel?.loadInitial();
	}
	updateContactList(contactListInfo, name, addresses) {
		contactListInfo.name = name;
		contactListInfo.groupInfo.name = name;
		this.entityClient.update(contactListInfo.groupInfo);
	}
	getSelectedContactListInfo() {
		return this.selectedContactList ? this.getContactListInfoForEntryListId(this.selectedContactList) : null;
	}
	getSelectedContactListEntries() {
		return this.listModel?.getSelectedAsArray();
	}
	async getRecipientsForList(listId) {
		return await this.entityClient.loadAll(ContactListEntryTypeRef, listId);
	}
	deleteContactList(contactList) {
		this.groupManagementFacade.deleteContactListGroup(contactList.groupRoot);
	}
	async deleteContactListEntries(recipients) {
		for (const recipient of recipients) await this.entityClient.erase(recipient);
	}
	removeUserFromContactList(contactList) {
		return locator.groupManagementFacade.removeUserFromGroup(getEtId(this.loginController.getUserController().user), contactList.groupInfo.group);
	}
	async deleteSelectedEntries() {
		await this.deleteContactListEntries(this.getSelectedContactListEntries() ?? []);
	}
	getContactListInfoForEntryListId(listId) {
		return this.getOwnContactListInfos().find((contactList) => contactList.groupRoot.entries === listId) ?? this.getSharedContactListInfos().find((contactList) => contactList.groupRoot.entries === listId) ?? null;
	}
	dispose() {
		this.eventController.removeEntityListener(this.entityEventsReceived);
		this.sortedContactListInfos.end(true);
		this.sortedSharedContactListInfos.end(true);
		this.contactListInvitations.dispose();
	}
};

//#endregion
export { ContactListViewModel };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ29udGFjdExpc3RWaWV3TW9kZWwtY2h1bmsuanMiLCJuYW1lcyI6WyJlbnRpdHlDbGllbnQ6IEVudGl0eUNsaWVudCIsImdyb3VwTWFuYWdlbWVudEZhY2FkZTogR3JvdXBNYW5hZ2VtZW50RmFjYWRlIiwibG9naW5Db250cm9sbGVyOiBMb2dpbkNvbnRyb2xsZXIiLCJldmVudENvbnRyb2xsZXI6IEV2ZW50Q29udHJvbGxlciIsImNvbnRhY3RNb2RlbDogQ29udGFjdE1vZGVsIiwiY29udGFjdExpc3RJbnZpdGF0aW9uczogUmVjZWl2ZWRHcm91cEludml0YXRpb25zTW9kZWw8R3JvdXBUeXBlLkNvbnRhY3RMaXN0PiIsInJvdXRlcjogUm91dGVyIiwidXBkYXRlVWk6ICgpID0+IHVua25vd24iLCJsaXN0SWQ/OiBJZCIsImVudHJ5SWQ/OiBJZCIsImxpc3RJZDogSWQiLCJfbGlzdElkOiBJZCIsImVsZW1lbnRJZDogSWQiLCJjb250YWN0TGlzdEVudHJ5SWQ6IElkIiwibmFtZTogc3RyaW5nIiwicmVjaXBpZW50czogc3RyaW5nW10iLCJhZGRyZXNzZXM6IHN0cmluZ1tdIiwiY29udGFjdExpc3RHcm91cFJvb3Q6IENvbnRhY3RMaXN0R3JvdXBSb290IiwicmVjaXBpZW50c0lkOiBJZCIsInJlY2lwaWVudDogQ29udGFjdExpc3RFbnRyeSIsInVwZGF0ZXM6IFJlYWRvbmx5QXJyYXk8RW50aXR5VXBkYXRlRGF0YT4iLCJzZWxlY3RlZDogSWQiLCJjb250YWN0TGlzdEluZm86IENvbnRhY3RMaXN0SW5mbyIsImNvbnRhY3RMaXN0OiBDb250YWN0TGlzdEluZm8iLCJyZWNpcGllbnRzOiBDb250YWN0TGlzdEVudHJ5W10iLCJsaXN0SWQ6IHN0cmluZyJdLCJzb3VyY2VzIjpbIi4uL3NyYy9tYWlsLWFwcC9jb250YWN0cy92aWV3L0NvbnRhY3RMaXN0Vmlld01vZGVsLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IExpc3RFbGVtZW50TGlzdE1vZGVsIH0gZnJvbSBcIi4uLy4uLy4uL2NvbW1vbi9taXNjL0xpc3RFbGVtZW50TGlzdE1vZGVsLmpzXCJcbmltcG9ydCB7XG5cdENvbnRhY3QsXG5cdENvbnRhY3RMaXN0RW50cnksXG5cdENvbnRhY3RMaXN0RW50cnlUeXBlUmVmLFxuXHRDb250YWN0TGlzdEdyb3VwUm9vdCxcblx0Q29udGFjdExpc3RHcm91cFJvb3RUeXBlUmVmLFxuXHRDb250YWN0VHlwZVJlZixcblx0Y3JlYXRlQ29udGFjdExpc3RFbnRyeSxcbn0gZnJvbSBcIi4uLy4uLy4uL2NvbW1vbi9hcGkvZW50aXRpZXMvdHV0YW5vdGEvVHlwZVJlZnMuanNcIlxuaW1wb3J0IHsgZ2V0RXRJZCwgaXNTYW1lSWQgfSBmcm9tIFwiLi4vLi4vLi4vY29tbW9uL2FwaS9jb21tb24vdXRpbHMvRW50aXR5VXRpbHMuanNcIlxuaW1wb3J0IHsgRW50aXR5Q2xpZW50IH0gZnJvbSBcIi4uLy4uLy4uL2NvbW1vbi9hcGkvY29tbW9uL0VudGl0eUNsaWVudC5qc1wiXG5pbXBvcnQgeyBHcm91cE1hbmFnZW1lbnRGYWNhZGUgfSBmcm9tIFwiLi4vLi4vLi4vY29tbW9uL2FwaS93b3JrZXIvZmFjYWRlcy9sYXp5L0dyb3VwTWFuYWdlbWVudEZhY2FkZS5qc1wiXG5pbXBvcnQgeyBMb2dpbkNvbnRyb2xsZXIgfSBmcm9tIFwiLi4vLi4vLi4vY29tbW9uL2FwaS9tYWluL0xvZ2luQ29udHJvbGxlci5qc1wiXG5pbXBvcnQgeyBhcnJheUVxdWFscywgZGVib3VuY2UsIGxhenlNZW1vaXplZCwgbWVtb2l6ZWQgfSBmcm9tIFwiQHR1dGFvL3R1dGFub3RhLXV0aWxzXCJcbmltcG9ydCB7IEVudGl0eUV2ZW50c0xpc3RlbmVyLCBFdmVudENvbnRyb2xsZXIgfSBmcm9tIFwiLi4vLi4vLi4vY29tbW9uL2FwaS9tYWluL0V2ZW50Q29udHJvbGxlci5qc1wiXG5pbXBvcnQgU3RyZWFtIGZyb20gXCJtaXRocmlsL3N0cmVhbVwiXG5pbXBvcnQgc3RyZWFtIGZyb20gXCJtaXRocmlsL3N0cmVhbVwiXG5pbXBvcnQgeyBSb3V0ZXIgfSBmcm9tIFwiLi4vLi4vLi4vY29tbW9uL2d1aS9TY29wZWRSb3V0ZXIuanNcIlxuaW1wb3J0IHsgQ29udGFjdExpc3RJbmZvLCBDb250YWN0TW9kZWwgfSBmcm9tIFwiLi4vLi4vLi4vY29tbW9uL2NvbnRhY3RzRnVuY3Rpb25hbGl0eS9Db250YWN0TW9kZWwuanNcIlxuaW1wb3J0IHsgUmVjZWl2ZWRHcm91cEludml0YXRpb24gfSBmcm9tIFwiLi4vLi4vLi4vY29tbW9uL2FwaS9lbnRpdGllcy9zeXMvVHlwZVJlZnMuanNcIlxuaW1wb3J0IHsgUmVjZWl2ZWRHcm91cEludml0YXRpb25zTW9kZWwgfSBmcm9tIFwiLi4vLi4vLi4vY29tbW9uL3NoYXJpbmcvbW9kZWwvUmVjZWl2ZWRHcm91cEludml0YXRpb25zTW9kZWwuanNcIlxuaW1wb3J0IHsgR3JvdXBUeXBlIH0gZnJvbSBcIi4uLy4uLy4uL2NvbW1vbi9hcGkvY29tbW9uL1R1dGFub3RhQ29uc3RhbnRzLmpzXCJcbmltcG9ydCB7IGxvY2F0b3IgfSBmcm9tIFwiLi4vLi4vLi4vY29tbW9uL2FwaS9tYWluL0NvbW1vbkxvY2F0b3IuanNcIlxuaW1wb3J0IHsgRW50aXR5VXBkYXRlRGF0YSwgaXNVcGRhdGVGb3JUeXBlUmVmIH0gZnJvbSBcIi4uLy4uLy4uL2NvbW1vbi9hcGkvY29tbW9uL3V0aWxzL0VudGl0eVVwZGF0ZVV0aWxzLmpzXCJcbmltcG9ydCB7IExpc3RBdXRvU2VsZWN0QmVoYXZpb3IgfSBmcm9tIFwiLi4vLi4vLi4vY29tbW9uL21pc2MvRGV2aWNlQ29uZmlnLmpzXCJcblxuZXhwb3J0IGNsYXNzIENvbnRhY3RMaXN0Vmlld01vZGVsIHtcblx0cHJpdmF0ZSBzZWxlY3RlZENvbnRhY3RMaXN0OiBJZCB8IG51bGwgPSBudWxsXG5cblx0Y29udGFjdHNGb3JTZWxlY3RlZEVudHJ5OiBDb250YWN0W10gPSBbXVxuXHRwcml2YXRlIGxpc3RNb2RlbFN0YXRlU3RyZWFtOiBTdHJlYW08dW5rbm93bj4gfCBudWxsID0gbnVsbFxuXHRwcml2YXRlIHNvcnRlZENvbnRhY3RMaXN0SW5mb3M6IFN0cmVhbTxSZWFkb25seUFycmF5PENvbnRhY3RMaXN0SW5mbz4+ID0gc3RyZWFtKFtdKVxuXHRwcml2YXRlIHNvcnRlZFNoYXJlZENvbnRhY3RMaXN0SW5mb3M6IFN0cmVhbTxSZWFkb25seUFycmF5PENvbnRhY3RMaXN0SW5mbz4+ID0gc3RyZWFtKFtdKVxuXG5cdGNvbnN0cnVjdG9yKFxuXHRcdHByaXZhdGUgcmVhZG9ubHkgZW50aXR5Q2xpZW50OiBFbnRpdHlDbGllbnQsXG5cdFx0cHJpdmF0ZSByZWFkb25seSBncm91cE1hbmFnZW1lbnRGYWNhZGU6IEdyb3VwTWFuYWdlbWVudEZhY2FkZSxcblx0XHRwcml2YXRlIHJlYWRvbmx5IGxvZ2luQ29udHJvbGxlcjogTG9naW5Db250cm9sbGVyLFxuXHRcdHByaXZhdGUgcmVhZG9ubHkgZXZlbnRDb250cm9sbGVyOiBFdmVudENvbnRyb2xsZXIsXG5cdFx0cHJpdmF0ZSByZWFkb25seSBjb250YWN0TW9kZWw6IENvbnRhY3RNb2RlbCxcblx0XHRwcml2YXRlIHJlYWRvbmx5IGNvbnRhY3RMaXN0SW52aXRhdGlvbnM6IFJlY2VpdmVkR3JvdXBJbnZpdGF0aW9uc01vZGVsPEdyb3VwVHlwZS5Db250YWN0TGlzdD4sXG5cdFx0cHJpdmF0ZSByZWFkb25seSByb3V0ZXI6IFJvdXRlcixcblx0XHRwcml2YXRlIHJlYWRvbmx5IHVwZGF0ZVVpOiAoKSA9PiB1bmtub3duLFxuXHQpIHt9XG5cblx0YXN5bmMgc2hvd0xpc3RBbmRFbnRyeShsaXN0SWQ/OiBJZCwgZW50cnlJZD86IElkKSB7XG5cdFx0dGhpcy5zZWxlY3RlZENvbnRhY3RMaXN0ID0gbGlzdElkID8/IG51bGxcblxuXHRcdC8vIG1ha2Ugc3VyZSB0aGF0IHdlIGhhdmUgdGhlIGxpc3QgaW5mb3MgYmVmb3JlIHdlIGNoZWNrIHdoZXRoZXIgdGhlIHBhc3NlZCBvbmUgaXMgaW4gdGhlbVxuXHRcdGF3YWl0IHRoaXMuaW5pdCgpXG5cdFx0Ly8gY2hlY2tpbmcgdGhhdCBubyBvbmUgY2hhbmdlZCB0aGUgbGlzdCBpbiB0aGUgbWVhbnRpbWUgY29uY3VycmVudGx5XG5cdFx0aWYgKHRoaXMuc2VsZWN0ZWRDb250YWN0TGlzdCA9PT0gbGlzdElkICYmICF0aGlzLmdldENvbnRhY3RMaXN0SW5mb0ZvckVudHJ5TGlzdElkKGxpc3RJZCkpIHtcblx0XHRcdHRoaXMuc2VsZWN0ZWRDb250YWN0TGlzdCA9IG51bGxcblx0XHR9XG5cdFx0YXdhaXQgdGhpcy5saXN0TW9kZWw/LmxvYWRJbml0aWFsKClcblxuXHRcdGlmIChsaXN0SWQgJiYgZW50cnlJZCkge1xuXHRcdFx0dGhpcy5sb2FkQW5kU2VsZWN0KGxpc3RJZCwgZW50cnlJZClcblx0XHR9XG5cdH1cblxuXHRyZWFkb25seSBpbml0ID0gbGF6eU1lbW9pemVkKGFzeW5jICgpID0+IHtcblx0XHR0aGlzLmV2ZW50Q29udHJvbGxlci5hZGRFbnRpdHlMaXN0ZW5lcih0aGlzLmVudGl0eUV2ZW50c1JlY2VpdmVkKVxuXHRcdHRoaXMuc29ydGVkQ29udGFjdExpc3RJbmZvcyA9IHRoaXMuY29udGFjdE1vZGVsLmdldE93bkNvbnRhY3RMaXN0SW5mb3MoKS5tYXAoKGluZm9zKSA9PiB7XG5cdFx0XHR0aGlzLnVwZGF0ZVVpKClcblx0XHRcdHJldHVybiBpbmZvcy5zbGljZSgpLnNvcnQoKGEsIGIpID0+IGEubmFtZS5sb2NhbGVDb21wYXJlKGIubmFtZSkpXG5cdFx0fSlcblx0XHR0aGlzLnNvcnRlZFNoYXJlZENvbnRhY3RMaXN0SW5mb3MgPSB0aGlzLmNvbnRhY3RNb2RlbC5nZXRTaGFyZWRDb250YWN0TGlzdEluZm9zKCkubWFwKChpbmZvcykgPT4ge1xuXHRcdFx0dGhpcy51cGRhdGVVaSgpXG5cdFx0XHRyZXR1cm4gaW5mb3Muc2xpY2UoKS5zb3J0KChhLCBiKSA9PiBhLm5hbWUubG9jYWxlQ29tcGFyZShiLm5hbWUpKVxuXHRcdH0pXG5cblx0XHR0aGlzLmNvbnRhY3RMaXN0SW52aXRhdGlvbnMuaW5pdCgpXG5cdFx0Ly8gZGlzcG9zZSgpIG9mIHRoZSBtb2RlbCB3aWxsIGVuZCB0aGlzIHN0cmVhbSwgbm8gbmVlZCB0byB1bnN1YnNjcmliZSBtYW51YWxseVxuXHRcdHRoaXMuY29udGFjdExpc3RJbnZpdGF0aW9ucy5pbnZpdGF0aW9ucy5tYXAodGhpcy51cGRhdGVVaSlcblx0XHRhd2FpdCB0aGlzLmNvbnRhY3RNb2RlbC5nZXRMb2FkZWRDb250YWN0TGlzdEluZm9zKClcblx0fSlcblxuXHRnZXQgbGlzdE1vZGVsKCk6IExpc3RFbGVtZW50TGlzdE1vZGVsPENvbnRhY3RMaXN0RW50cnk+IHwgbnVsbCB7XG5cdFx0cmV0dXJuIHRoaXMuc2VsZWN0ZWRDb250YWN0TGlzdCA/IHRoaXMuX2xpc3RNb2RlbCh0aGlzLnNlbGVjdGVkQ29udGFjdExpc3QpIDogbnVsbFxuXHR9XG5cblx0cHJpdmF0ZSByZWFkb25seSBfbGlzdE1vZGVsID0gbWVtb2l6ZWQoKGxpc3RJZDogSWQpID0+IHtcblx0XHRjb25zdCBuZXdMaXN0TW9kZWwgPSBuZXcgTGlzdEVsZW1lbnRMaXN0TW9kZWw8Q29udGFjdExpc3RFbnRyeT4oe1xuXHRcdFx0ZmV0Y2g6IGFzeW5jICgpID0+IHtcblx0XHRcdFx0Y29uc3QgaXRlbXMgPSBhd2FpdCB0aGlzLmdldFJlY2lwaWVudHNGb3JMaXN0KGxpc3RJZClcblx0XHRcdFx0cmV0dXJuIHsgaXRlbXMsIGNvbXBsZXRlOiB0cnVlIH1cblx0XHRcdH0sXG5cdFx0XHRsb2FkU2luZ2xlOiBhc3luYyAoX2xpc3RJZDogSWQsIGVsZW1lbnRJZDogSWQpID0+IHtcblx0XHRcdFx0cmV0dXJuIHRoaXMuZW50aXR5Q2xpZW50LmxvYWQoQ29udGFjdExpc3RFbnRyeVR5cGVSZWYsIFtsaXN0SWQsIGVsZW1lbnRJZF0pXG5cdFx0XHR9LFxuXHRcdFx0c29ydENvbXBhcmU6IChybDEsIHJsMikgPT4gcmwxLmVtYWlsQWRkcmVzcy5sb2NhbGVDb21wYXJlKHJsMi5lbWFpbEFkZHJlc3MpLFxuXHRcdFx0YXV0b1NlbGVjdEJlaGF2aW9yOiAoKSA9PiBMaXN0QXV0b1NlbGVjdEJlaGF2aW9yLk9MREVSLFxuXHRcdH0pXG5cblx0XHR0aGlzLmxpc3RNb2RlbFN0YXRlU3RyZWFtPy5lbmQodHJ1ZSlcblxuXHRcdHRoaXMubGlzdE1vZGVsU3RhdGVTdHJlYW0gPSBuZXdMaXN0TW9kZWwuc3RhdGVTdHJlYW0ubWFwKCgpID0+IHtcblx0XHRcdHRoaXMuY29udGFjdHNGb3JTZWxlY3RlZEVudHJ5ID0gW11cblx0XHRcdHRoaXMudXBkYXRlVWkoKVxuXHRcdFx0dGhpcy51cGRhdGVVcmwoKVxuXHRcdFx0dGhpcy5nZXRDb250YWN0c0ZvclNlbGVjdGVkQ29udGFjdExpc3RFbnRyeSgpXG5cdFx0fSlcblxuXHRcdHJldHVybiBuZXdMaXN0TW9kZWxcblx0fSlcblxuXHRwcml2YXRlIGFzeW5jIGxvYWRBbmRTZWxlY3QobGlzdElkOiBJZCwgY29udGFjdExpc3RFbnRyeUlkOiBJZCkge1xuXHRcdGF3YWl0IHRoaXMubGlzdE1vZGVsPy5sb2FkQW5kU2VsZWN0KGNvbnRhY3RMaXN0RW50cnlJZCwgKCkgPT4gdGhpcy5zZWxlY3RlZENvbnRhY3RMaXN0ICE9PSBsaXN0SWQpXG5cdH1cblxuXHRnZXRDb250YWN0TGlzdElkKCk6IFByb21pc2U8SWQgfCBudWxsPiB7XG5cdFx0cmV0dXJuIHRoaXMuY29udGFjdE1vZGVsLmdldENvbnRhY3RMaXN0SWQoKVxuXHR9XG5cblx0Z2V0T3duQ29udGFjdExpc3RJbmZvcygpOiBSZWFkb25seUFycmF5PENvbnRhY3RMaXN0SW5mbz4ge1xuXHRcdHJldHVybiB0aGlzLnNvcnRlZENvbnRhY3RMaXN0SW5mb3MoKSA/PyBbXVxuXHR9XG5cblx0Z2V0U2hhcmVkQ29udGFjdExpc3RJbmZvcygpOiBSZWFkb25seUFycmF5PENvbnRhY3RMaXN0SW5mbz4ge1xuXHRcdHJldHVybiB0aGlzLnNvcnRlZFNoYXJlZENvbnRhY3RMaXN0SW5mb3MoKSA/PyBbXVxuXHR9XG5cblx0Z2V0Q29udGFjdExpc3RJbnZpdGF0aW9ucygpOiBBcnJheTxSZWNlaXZlZEdyb3VwSW52aXRhdGlvbj4ge1xuXHRcdHJldHVybiB0aGlzLmNvbnRhY3RMaXN0SW52aXRhdGlvbnMuaW52aXRhdGlvbnMoKVxuXHR9XG5cblx0cHJpdmF0ZSByZWFkb25seSBnZXRDb250YWN0c0ZvclNlbGVjdGVkQ29udGFjdExpc3RFbnRyeSA9IGRlYm91bmNlKDUwLCBhc3luYyAoKSA9PiB7XG5cdFx0Y29uc3Qgc2VsZWN0ZWQgPSB0aGlzLmdldFNlbGVjdGVkQ29udGFjdExpc3RFbnRyaWVzKClcblx0XHRpZiAoc2VsZWN0ZWQ/Lmxlbmd0aCA9PT0gMSkge1xuXHRcdFx0Y29uc3Qgc2VhcmNoZWRDb250YWN0cyA9IGF3YWl0IHRoaXMuY29udGFjdE1vZGVsLnNlYXJjaEZvckNvbnRhY3RzKHNlbGVjdGVkWzBdLmVtYWlsQWRkcmVzcywgXCJtYWlsQWRkcmVzc1wiLCAxMClcblx0XHRcdC8vIG5lZWQgYW4gZXhhY3QgbWF0Y2hcblx0XHRcdGNvbnN0IGNvbnRhY3RzID0gc2VhcmNoZWRDb250YWN0cy5maWx0ZXIoKGNvbnRhY3QpID0+XG5cdFx0XHRcdGNvbnRhY3QubWFpbEFkZHJlc3Nlcy5tYXAoKG1haWxBZGRyZXNzKSA9PiBtYWlsQWRkcmVzcy5hZGRyZXNzKS5pbmNsdWRlcyhzZWxlY3RlZFswXS5lbWFpbEFkZHJlc3MpLFxuXHRcdFx0KVxuXHRcdFx0Y29uc3Qgbm93U2VsZWN0ZWQgPSB0aGlzLmdldFNlbGVjdGVkQ29udGFjdExpc3RFbnRyaWVzKCkgPz8gW11cblx0XHRcdGlmIChhcnJheUVxdWFscyhzZWxlY3RlZCwgbm93U2VsZWN0ZWQpKSB7XG5cdFx0XHRcdHRoaXMuY29udGFjdHNGb3JTZWxlY3RlZEVudHJ5ID0gY29udGFjdHNcblx0XHRcdH1cblx0XHR9IGVsc2Uge1xuXHRcdFx0cmV0dXJuIFtdXG5cdFx0fVxuXHRcdHRoaXMudXBkYXRlVWkoKVxuXHR9KVxuXG5cdHByaXZhdGUgdXBkYXRlVXJsKCkge1xuXHRcdGlmICghdGhpcy5saXN0TW9kZWw/LnN0YXRlLmluTXVsdGlzZWxlY3QpIHtcblx0XHRcdGNvbnN0IHJlY2lwaWVudCA9IHRoaXMuZ2V0U2VsZWN0ZWRDb250YWN0TGlzdEVudHJpZXMoKVxuXHRcdFx0aWYgKHJlY2lwaWVudCAmJiByZWNpcGllbnQubGVuZ3RoID09PSAxKSB7XG5cdFx0XHRcdHRoaXMucm91dGVyLnJvdXRlVG8oYC9jb250YWN0bGlzdC86bGlzdElkLzppdGVtSWRgLCB7XG5cdFx0XHRcdFx0bGlzdElkOiB0aGlzLnNlbGVjdGVkQ29udGFjdExpc3QsXG5cdFx0XHRcdFx0aXRlbUlkOiByZWNpcGllbnRbMF0uX2lkWzFdLFxuXHRcdFx0XHR9KVxuXHRcdFx0XHRyZXR1cm5cblx0XHRcdH1cblx0XHR9XG5cdFx0aWYgKHRoaXMuc2VsZWN0ZWRDb250YWN0TGlzdCkge1xuXHRcdFx0dGhpcy5yb3V0ZXIucm91dGVUbyhgL2NvbnRhY3RsaXN0LzpsaXN0SWRgLCB7IGxpc3RJZDogdGhpcy5zZWxlY3RlZENvbnRhY3RMaXN0IH0pXG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMucm91dGVyLnJvdXRlVG8oYC9jb250YWN0bGlzdGAsIHt9KVxuXHRcdH1cblx0fVxuXG5cdGFzeW5jIGNhbkNyZWF0ZUNvbnRhY3RMaXN0KCk6IFByb21pc2U8Ym9vbGVhbj4ge1xuXHRcdGNvbnN0IHBsYW5Db25maWcgPSBhd2FpdCB0aGlzLmxvZ2luQ29udHJvbGxlci5nZXRVc2VyQ29udHJvbGxlcigpLmdldFBsYW5Db25maWcoKVxuXHRcdHJldHVybiBwbGFuQ29uZmlnLmNvbnRhY3RMaXN0XG5cdH1cblxuXHRhc3luYyBhZGRDb250YWN0TGlzdChuYW1lOiBzdHJpbmcsIHJlY2lwaWVudHM6IHN0cmluZ1tdKSB7XG5cdFx0Y29uc3QgbmV3R3JvdXAgPSBhd2FpdCB0aGlzLmdyb3VwTWFuYWdlbWVudEZhY2FkZS5jcmVhdGVDb250YWN0TGlzdEdyb3VwKG5hbWUpXG5cdFx0Y29uc3QgbmV3Q29udGFjdExpc3QgPSBhd2FpdCB0aGlzLmVudGl0eUNsaWVudC5sb2FkKENvbnRhY3RMaXN0R3JvdXBSb290VHlwZVJlZiwgbmV3R3JvdXAuX2lkKVxuXG5cdFx0dGhpcy5hZGRSZWNpcGllbnRzdG9Db250YWN0TGlzdChyZWNpcGllbnRzLCBuZXdDb250YWN0TGlzdClcblx0fVxuXG5cdGFzeW5jIGFkZFJlY2lwaWVudHN0b0NvbnRhY3RMaXN0KGFkZHJlc3Nlczogc3RyaW5nW10sIGNvbnRhY3RMaXN0R3JvdXBSb290OiBDb250YWN0TGlzdEdyb3VwUm9vdCkge1xuXHRcdGNvbnN0IGN1cnJlbnRSZWNpcGllbnRzID0gYXdhaXQgdGhpcy5nZXRSZWNpcGllbnRzRm9yTGlzdChjb250YWN0TGlzdEdyb3VwUm9vdC5lbnRyaWVzKVxuXHRcdGNvbnN0IGxpc3RBZGRyZXNzZXMgPSBjdXJyZW50UmVjaXBpZW50cy5tYXAoKGVudHJ5KSA9PiBlbnRyeS5lbWFpbEFkZHJlc3MpXG5cdFx0Zm9yIChjb25zdCBhZGRyZXNzIG9mIGFkZHJlc3Nlcykge1xuXHRcdFx0aWYgKCFsaXN0QWRkcmVzc2VzLmluY2x1ZGVzKGFkZHJlc3MpKSB7XG5cdFx0XHRcdGNvbnN0IHJlY2lwaWVudCA9IGNyZWF0ZUNvbnRhY3RMaXN0RW50cnkoe1xuXHRcdFx0XHRcdF9vd25lckdyb3VwOiBjb250YWN0TGlzdEdyb3VwUm9vdC5faWQsXG5cdFx0XHRcdFx0ZW1haWxBZGRyZXNzOiBhZGRyZXNzLFxuXHRcdFx0XHR9KVxuXG5cdFx0XHRcdHRoaXMuYWRkRW50cnlPbkxpc3QoY29udGFjdExpc3RHcm91cFJvb3QuZW50cmllcywgcmVjaXBpZW50KVxuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdGFkZEVudHJ5T25MaXN0KHJlY2lwaWVudHNJZDogSWQsIHJlY2lwaWVudDogQ29udGFjdExpc3RFbnRyeSkge1xuXHRcdHRoaXMuZW50aXR5Q2xpZW50LnNldHVwKHJlY2lwaWVudHNJZCwgcmVjaXBpZW50KVxuXHR9XG5cblx0cHJpdmF0ZSByZWFkb25seSBlbnRpdHlFdmVudHNSZWNlaXZlZDogRW50aXR5RXZlbnRzTGlzdGVuZXIgPSBhc3luYyAodXBkYXRlczogUmVhZG9ubHlBcnJheTxFbnRpdHlVcGRhdGVEYXRhPik6IFByb21pc2U8dm9pZD4gPT4ge1xuXHRcdGZvciAoY29uc3QgdXBkYXRlIG9mIHVwZGF0ZXMpIHtcblx0XHRcdGlmICh0aGlzLnNlbGVjdGVkQ29udGFjdExpc3QpIHtcblx0XHRcdFx0Y29uc3QgeyBpbnN0YW5jZUxpc3RJZCwgaW5zdGFuY2VJZCwgb3BlcmF0aW9uIH0gPSB1cGRhdGVcblx0XHRcdFx0aWYgKGlzVXBkYXRlRm9yVHlwZVJlZihDb250YWN0TGlzdEVudHJ5VHlwZVJlZiwgdXBkYXRlKSAmJiBpc1NhbWVJZCh0aGlzLnNlbGVjdGVkQ29udGFjdExpc3QsIGluc3RhbmNlTGlzdElkKSkge1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMubGlzdE1vZGVsPy5lbnRpdHlFdmVudFJlY2VpdmVkKGluc3RhbmNlTGlzdElkLCBpbnN0YW5jZUlkLCBvcGVyYXRpb24pXG5cdFx0XHRcdH0gZWxzZSBpZiAoaXNVcGRhdGVGb3JUeXBlUmVmKENvbnRhY3RUeXBlUmVmLCB1cGRhdGUpKSB7XG5cdFx0XHRcdFx0dGhpcy5nZXRDb250YWN0c0ZvclNlbGVjdGVkQ29udGFjdExpc3RFbnRyeSgpXG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0dGhpcy51cGRhdGVVaSgpXG5cdFx0fVxuXHR9XG5cblx0dXBkYXRlU2VsZWN0ZWRDb250YWN0TGlzdChzZWxlY3RlZDogSWQpOiB2b2lkIHtcblx0XHR0aGlzLnNlbGVjdGVkQ29udGFjdExpc3QgPSBzZWxlY3RlZFxuXHRcdHRoaXMubGlzdE1vZGVsPy5sb2FkSW5pdGlhbCgpXG5cdH1cblxuXHR1cGRhdGVDb250YWN0TGlzdChjb250YWN0TGlzdEluZm86IENvbnRhY3RMaXN0SW5mbywgbmFtZTogc3RyaW5nLCBhZGRyZXNzZXM6IHN0cmluZ1tdKTogdm9pZCB7XG5cdFx0Ly8gdGhlIG5hbWUgaXMgc3RvcmVkIG9uIGJvdGggR3JvdXBJbmZvIChvd24gY29udGFjdCBsaXN0KSBhbmQgVXNlclNldHRpbmdzR3JvdXBSb290IChjb250YWN0IGxpc3RzIHNoYXJlZCB3aXRoIHVzKVxuXHRcdC8vIG5vdGU6IG1ha2Ugc3VyZSB0byBoYW5kbGUgc2hhcmVkIGNvbnRhY3QgbGlzdHMgd2hlbiBpbXBsZW1lbnRpbmcgc2hhcmluZ1xuXHRcdGNvbnRhY3RMaXN0SW5mby5uYW1lID0gbmFtZVxuXHRcdGNvbnRhY3RMaXN0SW5mby5ncm91cEluZm8ubmFtZSA9IG5hbWVcblx0XHR0aGlzLmVudGl0eUNsaWVudC51cGRhdGUoY29udGFjdExpc3RJbmZvLmdyb3VwSW5mbylcblx0fVxuXG5cdGdldFNlbGVjdGVkQ29udGFjdExpc3RJbmZvKCk6IENvbnRhY3RMaXN0SW5mbyB8IG51bGwge1xuXHRcdHJldHVybiB0aGlzLnNlbGVjdGVkQ29udGFjdExpc3QgPyB0aGlzLmdldENvbnRhY3RMaXN0SW5mb0ZvckVudHJ5TGlzdElkKHRoaXMuc2VsZWN0ZWRDb250YWN0TGlzdCkgOiBudWxsXG5cdH1cblxuXHRnZXRTZWxlY3RlZENvbnRhY3RMaXN0RW50cmllcygpOiBDb250YWN0TGlzdEVudHJ5W10gfCB1bmRlZmluZWQge1xuXHRcdHJldHVybiB0aGlzLmxpc3RNb2RlbD8uZ2V0U2VsZWN0ZWRBc0FycmF5KClcblx0fVxuXG5cdGFzeW5jIGdldFJlY2lwaWVudHNGb3JMaXN0KGxpc3RJZDogSWQpOiBQcm9taXNlPENvbnRhY3RMaXN0RW50cnlbXT4ge1xuXHRcdHJldHVybiBhd2FpdCB0aGlzLmVudGl0eUNsaWVudC5sb2FkQWxsKENvbnRhY3RMaXN0RW50cnlUeXBlUmVmLCBsaXN0SWQpXG5cdH1cblxuXHRkZWxldGVDb250YWN0TGlzdChjb250YWN0TGlzdDogQ29udGFjdExpc3RJbmZvKSB7XG5cdFx0dGhpcy5ncm91cE1hbmFnZW1lbnRGYWNhZGUuZGVsZXRlQ29udGFjdExpc3RHcm91cChjb250YWN0TGlzdC5ncm91cFJvb3QpXG5cdH1cblxuXHRhc3luYyBkZWxldGVDb250YWN0TGlzdEVudHJpZXMocmVjaXBpZW50czogQ29udGFjdExpc3RFbnRyeVtdKSB7XG5cdFx0Zm9yIChjb25zdCByZWNpcGllbnQgb2YgcmVjaXBpZW50cykge1xuXHRcdFx0YXdhaXQgdGhpcy5lbnRpdHlDbGllbnQuZXJhc2UocmVjaXBpZW50KVxuXHRcdH1cblx0fVxuXG5cdHJlbW92ZVVzZXJGcm9tQ29udGFjdExpc3QoY29udGFjdExpc3Q6IENvbnRhY3RMaXN0SW5mbykge1xuXHRcdHJldHVybiBsb2NhdG9yLmdyb3VwTWFuYWdlbWVudEZhY2FkZS5yZW1vdmVVc2VyRnJvbUdyb3VwKGdldEV0SWQodGhpcy5sb2dpbkNvbnRyb2xsZXIuZ2V0VXNlckNvbnRyb2xsZXIoKS51c2VyKSwgY29udGFjdExpc3QuZ3JvdXBJbmZvLmdyb3VwKVxuXHR9XG5cblx0YXN5bmMgZGVsZXRlU2VsZWN0ZWRFbnRyaWVzKCkge1xuXHRcdGF3YWl0IHRoaXMuZGVsZXRlQ29udGFjdExpc3RFbnRyaWVzKHRoaXMuZ2V0U2VsZWN0ZWRDb250YWN0TGlzdEVudHJpZXMoKSA/PyBbXSlcblx0fVxuXG5cdHByaXZhdGUgZ2V0Q29udGFjdExpc3RJbmZvRm9yRW50cnlMaXN0SWQobGlzdElkOiBzdHJpbmcpOiBDb250YWN0TGlzdEluZm8gfCBudWxsIHtcblx0XHRyZXR1cm4gKFxuXHRcdFx0dGhpcy5nZXRPd25Db250YWN0TGlzdEluZm9zKCkuZmluZCgoY29udGFjdExpc3QpID0+IGNvbnRhY3RMaXN0Lmdyb3VwUm9vdC5lbnRyaWVzID09PSBsaXN0SWQpID8/XG5cdFx0XHR0aGlzLmdldFNoYXJlZENvbnRhY3RMaXN0SW5mb3MoKS5maW5kKChjb250YWN0TGlzdCkgPT4gY29udGFjdExpc3QuZ3JvdXBSb290LmVudHJpZXMgPT09IGxpc3RJZCkgPz9cblx0XHRcdG51bGxcblx0XHQpXG5cdH1cblxuXHRkaXNwb3NlKCkge1xuXHRcdHRoaXMuZXZlbnRDb250cm9sbGVyLnJlbW92ZUVudGl0eUxpc3RlbmVyKHRoaXMuZW50aXR5RXZlbnRzUmVjZWl2ZWQpXG5cdFx0dGhpcy5zb3J0ZWRDb250YWN0TGlzdEluZm9zLmVuZCh0cnVlKVxuXHRcdHRoaXMuc29ydGVkU2hhcmVkQ29udGFjdExpc3RJbmZvcy5lbmQodHJ1ZSlcblx0XHR0aGlzLmNvbnRhY3RMaXN0SW52aXRhdGlvbnMuZGlzcG9zZSgpXG5cdH1cbn1cbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0lBMkJhLHVCQUFOLE1BQTJCO0NBQ2pDLEFBQVEsc0JBQWlDO0NBRXpDLDJCQUFzQyxDQUFFO0NBQ3hDLEFBQVEsdUJBQStDO0NBQ3ZELEFBQVEseUJBQWlFLDJCQUFPLENBQUUsRUFBQztDQUNuRixBQUFRLCtCQUF1RSwyQkFBTyxDQUFFLEVBQUM7Q0FFekYsWUFDa0JBLGNBQ0FDLHVCQUNBQyxpQkFDQUMsaUJBQ0FDLGNBQ0FDLHdCQUNBQyxRQUNBQyxVQUNoQjtFQWdPRixLQXhPa0I7RUF3T2pCLEtBdk9pQjtFQXVPaEIsS0F0T2dCO0VBc09mLEtBck9lO0VBcU9kLEtBcE9jO0VBb09iLEtBbk9hO0VBbU9aLEtBbE9ZO0VBa09YLEtBak9XO0NBQ2Q7Q0FFSixNQUFNLGlCQUFpQkMsUUFBYUMsU0FBYztBQUNqRCxPQUFLLHNCQUFzQixVQUFVO0FBR3JDLFFBQU0sS0FBSyxNQUFNO0FBRWpCLE1BQUksS0FBSyx3QkFBd0IsV0FBVyxLQUFLLGlDQUFpQyxPQUFPLENBQ3hGLE1BQUssc0JBQXNCO0FBRTVCLFFBQU0sS0FBSyxXQUFXLGFBQWE7QUFFbkMsTUFBSSxVQUFVLFFBQ2IsTUFBSyxjQUFjLFFBQVEsUUFBUTtDQUVwQztDQUVELEFBQVMsT0FBTyxhQUFhLFlBQVk7QUFDeEMsT0FBSyxnQkFBZ0Isa0JBQWtCLEtBQUsscUJBQXFCO0FB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