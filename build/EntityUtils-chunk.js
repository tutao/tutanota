import { base64ExtToBase64, base64ToBase64Ext, base64ToBase64Url, base64ToUint8Array, base64UrlToBase64, clone, compare, hexToBase64, isSameTypeRef, pad, repeat, stringToUtf8Uint8Array, uint8ArrayToBase64, utf8Uint8ArrayToString } from "./dist2-chunk.js";

//#region src/common/api/common/EntityConstants.js
const Type = Object.freeze({
	Element: "ELEMENT_TYPE",
	ListElement: "LIST_ELEMENT_TYPE",
	DataTransfer: "DATA_TRANSFER_TYPE",
	Aggregated: "AGGREGATED_TYPE",
	BlobElement: "BLOB_ELEMENT_TYPE"
});
const Cardinality = Object.freeze({
	ZeroOrOne: "ZeroOrOne",
	Any: "Any",
	One: "One"
});
const AssociationType = Object.freeze({
	ElementAssociation: "ELEMENT_ASSOCIATION",
	ListAssociation: "LIST_ASSOCIATION",
	ListElementAssociationGenerated: "LIST_ELEMENT_ASSOCIATION_GENERATED",
	Aggregation: "AGGREGATION",
	BlobElementAssociation: "BLOB_ELEMENT_ASSOCIATION",
	ListElementAssociationCustom: "LIST_ELEMENT_ASSOCIATION_CUSTOM"
});
const ValueType = Object.freeze({
	String: "String",
	Number: "Number",
	Bytes: "Bytes",
	Date: "Date",
	Boolean: "Boolean",
	GeneratedId: "GeneratedId",
	CustomId: "CustomId",
	CompressedString: "CompressedString"
});
const ResourceType = Object.freeze({
	Persistence: "Persistence",
	Service: "Service"
});

//#endregion
//#region src/common/api/common/utils/EntityUtils.ts
const GENERATED_MAX_ID = "zzzzzzzzzzzz";
const DEFAULT_MAILSET_ENTRY_CUSTOM_CUTOFF_TIMESTAMP = new Date("2109-05-16T15:00Z").getTime();
const GENERATED_MIN_ID = "------------";
const GENERATED_ID_BYTES_LENGTH = 9;
const MAIL_SET_ENTRY_ID_BYTE_LENGTH = 13;
const CUSTOM_MIN_ID = "";
const CUSTOM_MAX_ID = repeat("_", 340);
const RANGE_ITEM_LIMIT = 1e3;
const LOAD_MULTIPLE_LIMIT = 100;
const POST_MULTIPLE_LIMIT = 100;
function firstBiggerThanSecond(firstId, secondId, typeModel) {
	if (typeModel?.values._id.type === ValueType.CustomId) return firstBiggerThanSecondCustomId(firstId, secondId);
else if (firstId.length > secondId.length) return true;
else if (secondId.length > firstId.length) return false;
else return firstId > secondId;
}
function firstBiggerThanSecondCustomId(firstId, secondId) {
	return compare(customIdToUint8array(firstId), customIdToUint8array(secondId)) === 1;
}
function customIdToUint8array(id) {
	if (id === "") return new Uint8Array();
	return base64ToUint8Array(base64UrlToBase64(id));
}
function compareNewestFirst(id1, id2) {
	let firstId = id1 instanceof Array ? id1[1] : id1;
	let secondId = id2 instanceof Array ? id2[1] : id2;
	if (firstId === secondId) return 0;
else return firstBiggerThanSecond(firstId, secondId) ? -1 : 1;
}
function compareOldestFirst(id1, id2) {
	let firstId = id1 instanceof Array ? id1[1] : id1;
	let secondId = id2 instanceof Array ? id2[1] : id2;
	if (firstId === secondId) return 0;
else return firstBiggerThanSecond(firstId, secondId) ? 1 : -1;
}
function sortCompareByReverseId(entity1, entity2) {
	return compareNewestFirst(getElementId(entity1), getElementId(entity2));
}
function isSameId(id1, id2) {
	if (id1 === null || id2 === null) return false;
else if (id1 instanceof Array && id2 instanceof Array) return id1[0] === id2[0] && id1[1] === id2[1];
else return id1 === id2;
}
function haveSameId(entity1, entity2) {
	return isSameId(entity1._id, entity2._id);
}
function containsId(ids, id) {
	return ids.some((idInArray) => isSameId(idInArray, id));
}
function getEtId(entity) {
	return entity._id;
}
function getLetId(entity) {
	if (typeof entity._id === "undefined") throw new Error("listId is not defined for " + (typeof entity._type === "undefined" ? JSON.stringify(entity) : entity));
	return entity._id;
}
function getElementId(entity) {
	return elementIdPart(getLetId(entity));
}
function getListId(entity) {
	return listIdPart(getLetId(entity));
}
function listIdPart(id) {
	return id[0];
}
function elementIdPart(id) {
	return id[1];
}
function stringToCustomId(string) {
	return uint8arrayToCustomId(stringToUtf8Uint8Array(string));
}
function uint8arrayToCustomId(array) {
	return base64ToBase64Url(uint8ArrayToBase64(array));
}
function customIdToString(customId) {
	return utf8Uint8ArrayToString(base64ToUint8Array(base64UrlToBase64(customId)));
}
function create(typeModel, typeRef, createDefaultValue = _getDefaultValue) {
	let i = { _type: typeRef };
	for (let valueName of Object.keys(typeModel.values)) {
		let value = typeModel.values[valueName];
		i[valueName] = createDefaultValue(valueName, value);
	}
	for (let associationName of Object.keys(typeModel.associations)) {
		let association = typeModel.associations[associationName];
		if (association.cardinality === Cardinality.Any) i[associationName] = [];
else i[associationName] = null;
	}
	return i;
}
function _getDefaultValue(valueName, value) {
	if (valueName === "_format") return "0";
else if (valueName === "_id") return null;
else if (valueName === "_permissions") return null;
else if (value.cardinality === Cardinality.ZeroOrOne) return null;
else switch (value.type) {
		case ValueType.Bytes: return new Uint8Array(0);
		case ValueType.Date: return new Date();
		case ValueType.Number: return "0";
		case ValueType.String: return "";
		case ValueType.Boolean: return false;
		case ValueType.CustomId:
		case ValueType.GeneratedId: return null;
	}
	throw new Error(`no default value for ${JSON.stringify(value)}`);
}
function timestampToHexGeneratedId(timestamp, serverBytes) {
	let id = timestamp * 4;
	let hex = id.toString(16) + "00000" + pad(serverBytes, 2);
	for (let length = hex.length; length < 18; length++) hex = "0" + hex;
	return hex;
}
function timestampToGeneratedId(timestamp, serverBytes = 0) {
	let hex = timestampToHexGeneratedId(timestamp, serverBytes);
	return base64ToBase64Ext(hexToBase64(hex));
}
function generatedIdToTimestamp(base64Ext) {
	const base64 = base64ExtToBase64(base64Ext);
	const decodedbB4 = atob(base64);
	let numberResult = 0;
	for (let i = 0; i < 5; i++) {
		numberResult = numberResult * 256;
		numberResult += decodedbB4.charCodeAt(i);
	}
	numberResult = numberResult * 4;
	numberResult += decodedbB4.charCodeAt(5) >>> 6;
	return numberResult;
}
const base64extEncodedIdLength = GENERATED_MAX_ID.length;
function assertIsEntity(entity, type) {
	if (isSameTypeRef(entity._type, type)) return true;
else return false;
}
function assertIsEntity2(type) {
	return (e) => assertIsEntity(e, type);
}
function removeTechnicalFields(entity) {
	function _removeTechnicalFields(erased) {
		for (const key of Object.keys(erased)) if (key.startsWith("_finalEncrypted") || key.startsWith("_defaultEncrypted") || key.startsWith("_errors")) delete erased[key];
else {
			const value = erased[key];
			if (value instanceof Object) _removeTechnicalFields(value);
		}
	}
	_removeTechnicalFields(entity);
}
function getStrippedClone(entity) {
	const cloned = clone(entity);
	removeTechnicalFields(cloned);
	removeIdentityFields(cloned);
	return cloned;
}
/**
* remove fields that do not contain user defined data but are related to finding/accessing the entity on the server
*/
function removeIdentityFields(entity) {
	const keysToDelete = [
		"_id",
		"_ownerGroup",
		"_ownerEncSessionKey",
		"_ownerKeyVersion",
		"_permissions"
	];
	function _removeIdentityFields(erased) {
		for (const key of Object.keys(erased)) if (keysToDelete.includes(key)) delete erased[key];
else {
			const value = erased[key];
			if (value instanceof Object) _removeIdentityFields(value);
		}
	}
	_removeIdentityFields(entity);
}
function constructMailSetEntryId(receiveDate, mailId) {
	const buffer = new DataView(new ArrayBuffer(MAIL_SET_ENTRY_ID_BYTE_LENGTH));
	const mailIdBytes = base64ToUint8Array(base64ExtToBase64(mailId));
	const timestamp = BigInt(Math.trunc(receiveDate.getTime()));
	const truncatedReceiveDate = timestamp >> 10n & 0x00000000ffffffffn;
	buffer.setBigUint64(0, truncatedReceiveDate << 32n);
	for (let i = 0; i < mailIdBytes.length; i++) buffer.setUint8(i + 4, mailIdBytes[i]);
	return uint8arrayToCustomId(new Uint8Array(buffer.buffer));
}
function deconstructMailSetEntryId(id) {
	const buffer = customIdToUint8array(id);
	const timestampBytes = buffer.slice(0, 4);
	const generatedIdBytes = buffer.slice(4);
	const timestamp1024 = timestampBytes[0] << 24 | timestampBytes[1] << 16 | timestampBytes[2] << 8 | timestampBytes[3];
	const timestamp = timestamp1024 * 1024;
	const mailId = base64ToBase64Ext(uint8ArrayToBase64(generatedIdBytes));
	return {
		receiveDate: new Date(timestamp),
		mailId
	};
}
const LEGACY_TO_RECIPIENTS_ID = 112;
const LEGACY_CC_RECIPIENTS_ID = 113;
const LEGACY_BCC_RECIPIENTS_ID = 114;
const LEGACY_BODY_ID = 116;

//#endregion
export { AssociationType, CUSTOM_MAX_ID, CUSTOM_MIN_ID, Cardinality, DEFAULT_MAILSET_ENTRY_CUSTOM_CUTOFF_TIMESTAMP, GENERATED_ID_BYTES_LENGTH, GENERATED_MAX_ID, GENERATED_MIN_ID, LEGACY_BCC_RECIPIENTS_ID, LEGACY_BODY_ID, LEGACY_CC_RECIPIENTS_ID, LEGACY_TO_RECIPIENTS_ID, LOAD_MULTIPLE_LIMIT, POST_MULTIPLE_LIMIT, RANGE_ITEM_LIMIT, Type, ValueType, assertIsEntity, assertIsEntity2, compareNewestFirst, compareOldestFirst, constructMailSetEntryId, containsId, create, customIdToString, customIdToUint8array, deconstructMailSetEntryId, elementIdPart, firstBiggerThanSecond, generatedIdToTimestamp, getElementId, getEtId, getLetId, getListId, getStrippedClone, haveSameId, isSameId, listIdPart, removeTechnicalFields, sortCompareByReverseId, stringToCustomId, timestampToGeneratedId, uint8arrayToCustomId };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiRW50aXR5VXRpbHMtY2h1bmsuanMiLCJuYW1lcyI6WyJmaXJzdElkOiBJZCIsInNlY29uZElkOiBJZCIsInR5cGVNb2RlbD86IFR5cGVNb2RlbCIsImlkOiBJZCIsImlkMTogSWQgfCBJZFR1cGxlIiwiaWQyOiBJZCB8IElkVHVwbGUiLCJlbnRpdHkxOiBUIiwiZW50aXR5MjogVCIsImlkMTogKElkIHwgSWRUdXBsZSkgfCBudWxsIiwiaWQyOiAoSWQgfCBJZFR1cGxlKSB8IG51bGwiLCJlbnRpdHkxOiBTb21lRW50aXR5IiwiZW50aXR5MjogU29tZUVudGl0eSIsImlkczogUmVhZG9ubHlBcnJheTxJZCB8IElkVHVwbGU+IiwiaWQ6IElkIHwgSWRUdXBsZSIsImVudGl0eTogRWxlbWVudCIsImVudGl0eTogTGlzdEVsZW1lbnQiLCJlbnRpdHk6IFQiLCJpZDogSWRUdXBsZSIsInN0cmluZzogc3RyaW5nIiwiYXJyYXk6IFVpbnQ4QXJyYXkiLCJjdXN0b21JZDogc3RyaW5nIiwidHlwZU1vZGVsOiBUeXBlTW9kZWwiLCJ0eXBlUmVmOiBUeXBlUmVmPFQ+IiwiY3JlYXRlRGVmYXVsdFZhbHVlOiAobmFtZTogc3RyaW5nLCB2YWx1ZTogTW9kZWxWYWx1ZSkgPT4gYW55IiwiaTogUmVjb3JkPHN0cmluZywgYW55PiIsInZhbHVlTmFtZTogc3RyaW5nIiwidmFsdWU6IE1vZGVsVmFsdWUiLCJ0aW1lc3RhbXA6IG51bWJlciIsInNlcnZlckJ5dGVzOiBudW1iZXIiLCJiYXNlNjRFeHQ6IElkIiwiZW50aXR5OiBTb21lRW50aXR5IiwidHlwZTogVHlwZVJlZjxUPiIsImVudGl0eTogRSIsImVyYXNlZDogUmVjb3JkPHN0cmluZywgYW55PiIsImVudGl0eTogU3RyaXBwZWRFbnRpdHk8RT4iLCJyZWNlaXZlRGF0ZTogRGF0ZSIsIm1haWxJZDogSWQiLCJ0aW1lc3RhbXA6IGJpZ2ludCJdLCJzb3VyY2VzIjpbIi4uL3NyYy9jb21tb24vYXBpL2NvbW1vbi9FbnRpdHlDb25zdGFudHMuanMiLCIuLi9zcmMvY29tbW9uL2FwaS9jb21tb24vdXRpbHMvRW50aXR5VXRpbHMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gV2UgY2Fubm90IHVzZSBUUyB0eXBlcyBoZXJlIGJlY2F1c2UgaXQncyB1c2VkIGR1cmluZyBidWlsZC4gVHlwZXMgZm9yIHRoZXNlIHRoaW5ncyBhcmUgc3RpbGwgaW5mZXJyZWQuXG5cbmV4cG9ydCBjb25zdCBUeXBlID0gT2JqZWN0LmZyZWV6ZSh7XG5cdEVsZW1lbnQ6IFwiRUxFTUVOVF9UWVBFXCIsXG5cdExpc3RFbGVtZW50OiBcIkxJU1RfRUxFTUVOVF9UWVBFXCIsXG5cdERhdGFUcmFuc2ZlcjogXCJEQVRBX1RSQU5TRkVSX1RZUEVcIixcblx0QWdncmVnYXRlZDogXCJBR0dSRUdBVEVEX1RZUEVcIixcblx0QmxvYkVsZW1lbnQ6IFwiQkxPQl9FTEVNRU5UX1RZUEVcIixcbn0pXG5cbmV4cG9ydCBjb25zdCBDYXJkaW5hbGl0eSA9IE9iamVjdC5mcmVlemUoe1xuXHRaZXJvT3JPbmU6IFwiWmVyb09yT25lXCIsXG5cdEFueTogXCJBbnlcIixcblx0T25lOiBcIk9uZVwiLFxufSlcblxuZXhwb3J0IGNvbnN0IEFzc29jaWF0aW9uVHlwZSA9IE9iamVjdC5mcmVlemUoe1xuXHRFbGVtZW50QXNzb2NpYXRpb246IFwiRUxFTUVOVF9BU1NPQ0lBVElPTlwiLFxuXHRMaXN0QXNzb2NpYXRpb246IFwiTElTVF9BU1NPQ0lBVElPTlwiLFxuXHRMaXN0RWxlbWVudEFzc29jaWF0aW9uR2VuZXJhdGVkOiBcIkxJU1RfRUxFTUVOVF9BU1NPQ0lBVElPTl9HRU5FUkFURURcIixcblx0QWdncmVnYXRpb246IFwiQUdHUkVHQVRJT05cIixcblx0QmxvYkVsZW1lbnRBc3NvY2lhdGlvbjogXCJCTE9CX0VMRU1FTlRfQVNTT0NJQVRJT05cIixcblx0TGlzdEVsZW1lbnRBc3NvY2lhdGlvbkN1c3RvbTogXCJMSVNUX0VMRU1FTlRfQVNTT0NJQVRJT05fQ1VTVE9NXCIsXG59KVxuXG5leHBvcnQgY29uc3QgVmFsdWVUeXBlID0gT2JqZWN0LmZyZWV6ZSh7XG5cdFN0cmluZzogXCJTdHJpbmdcIixcblx0TnVtYmVyOiBcIk51bWJlclwiLFxuXHRCeXRlczogXCJCeXRlc1wiLFxuXHREYXRlOiBcIkRhdGVcIixcblx0Qm9vbGVhbjogXCJCb29sZWFuXCIsXG5cdEdlbmVyYXRlZElkOiBcIkdlbmVyYXRlZElkXCIsXG5cdEN1c3RvbUlkOiBcIkN1c3RvbUlkXCIsXG5cdENvbXByZXNzZWRTdHJpbmc6IFwiQ29tcHJlc3NlZFN0cmluZ1wiLFxufSlcblxuZXhwb3J0IGNvbnN0IFJlc291cmNlVHlwZSA9IE9iamVjdC5mcmVlemUoe1xuXHRQZXJzaXN0ZW5jZTogXCJQZXJzaXN0ZW5jZVwiLFxuXHRTZXJ2aWNlOiBcIlNlcnZpY2VcIixcbn0pXG4iLCJpbXBvcnQge1xuXHRiYXNlNjRFeHRUb0Jhc2U2NCxcblx0YmFzZTY0VG9CYXNlNjRFeHQsXG5cdGJhc2U2NFRvQmFzZTY0VXJsLFxuXHRiYXNlNjRUb1VpbnQ4QXJyYXksXG5cdGJhc2U2NFVybFRvQmFzZTY0LFxuXHRjbG9uZSxcblx0Y29tcGFyZSxcblx0SGV4LFxuXHRoZXhUb0Jhc2U2NCxcblx0aXNTYW1lVHlwZVJlZixcblx0cGFkLFxuXHRyZXBlYXQsXG5cdHN0cmluZ1RvVXRmOFVpbnQ4QXJyYXksXG5cdFR5cGVSZWYsXG5cdHVpbnQ4QXJyYXlUb0Jhc2U2NCxcblx0dXRmOFVpbnQ4QXJyYXlUb1N0cmluZyxcbn0gZnJvbSBcIkB0dXRhby90dXRhbm90YS11dGlsc1wiXG5pbXBvcnQgeyBDYXJkaW5hbGl0eSwgVmFsdWVUeXBlIH0gZnJvbSBcIi4uL0VudGl0eUNvbnN0YW50cy5qc1wiXG5pbXBvcnQgdHlwZSB7IEVsZW1lbnRFbnRpdHksIEVudGl0eSwgTW9kZWxWYWx1ZSwgU29tZUVudGl0eSwgVHlwZU1vZGVsIH0gZnJvbSBcIi4uL0VudGl0eVR5cGVzXCJcblxuLyoqXG4gKiB0aGUgbWF4aW11bSBJRCBmb3IgZWxlbWVudHMgc3RvcmVkIG9uIHRoZSBzZXJ2ZXIgKG51bWJlciB3aXRoIHRoZSBsZW5ndGggb2YgMTAgYnl0ZXMpID0+IDJeODAgLSAxXG4gKi9cbmV4cG9ydCBjb25zdCBHRU5FUkFURURfTUFYX0lEID0gXCJ6enp6enp6enp6enpcIlxuLyoqXG4gKiB3ZSBzdXBwb3J0IGNyZWF0aW9uIG9mIGN1c3RvbUlkcyBmb3IgbWFpbHNldCBlbnRyaWVzIHVudGlsIGFyb3VuZCB0aGlzIGRhdGUuXG4gKlxuICogdGhpcyBpcyBpbnRlbmRlZCB0byBiZSBhZnRlciBhbnkgcmVhc29uYWJsZSByZWFsIGN1c3RvbSBpZCB3ZSBnZW5lcmF0ZSBmb3IgbWFpbCBzZXQgZW50cmllcy5cbiAqXG4gKiBjdXJyZW50IG1haWxTZXRFbnRyeSBtYXhpbXVtIGRhdGUgaXM6IDIwMTktMDUtMTUgLWlzaCAoIHNlZSBNYWlsRm9sZGVySGVscGVyLmphdmE6IG1ha2VNYWlsU2V0RW50cnlDdXN0b21JZCApXG4gKi9cbmV4cG9ydCBjb25zdCBERUZBVUxUX01BSUxTRVRfRU5UUllfQ1VTVE9NX0NVVE9GRl9USU1FU1RBTVAgPSBuZXcgRGF0ZShcIjIxMDktMDUtMTZUMTU6MDBaXCIpLmdldFRpbWUoKVxuXG4vKipcbiAqIFRoZSBtaW5pbXVtIElEIGZvciBlbGVtZW50cyB3aXRoIGdlbmVyYXRlZCBpZCBzdG9yZWQgb24gdGhlIHNlcnZlclxuICovXG5leHBvcnQgY29uc3QgR0VORVJBVEVEX01JTl9JRCA9IFwiLS0tLS0tLS0tLS0tXCJcblxuLyoqXG4gKiBUaGUgYnl0ZSBsZW5ndGggb2YgYSBnZW5lcmF0ZWQgaWRcbiAqL1xuZXhwb3J0IGNvbnN0IEdFTkVSQVRFRF9JRF9CWVRFU19MRU5HVEggPSA5XG5cbi8qKlxuICogVGhlIGJ5dGUgbGVuZ3RoIG9mIGEgY3VzdG9tIElkIHVzZWQgYnkgbWFpbCBzZXQgZW50cmllc1xuICogNCBieXRlcyB0aW1lc3RhbXAgKDEwMjRtcyByZXNvbHV0aW9uKVxuICogOSBieXRlcyBtYWlsIGVsZW1lbnQgSWRcbiAqL1xuZXhwb3J0IGNvbnN0IE1BSUxfU0VUX0VOVFJZX0lEX0JZVEVfTEVOR1RIID0gMTNcblxuLyoqXG4gKiBUaGUgbWluaW11bSBJRCBmb3IgZWxlbWVudHMgd2l0aCBjdXN0b20gaWQgc3RvcmVkIG9uIHRoZSBzZXJ2ZXJcbiAqL1xuZXhwb3J0IGNvbnN0IENVU1RPTV9NSU5fSUQgPSBcIlwiXG4vKipcbiAqIHRoZSBtYXhpbXVtIGN1c3RvbSBlbGVtZW50IGlkIGlzIGVuZm9yY2VkIHRvIGJlIGxlc3MgdGhhbiAyNTYgYnl0ZXMgb24gdGhlIHNlcnZlci4gZGVjb2RpbmcgdGhpcyBhcyBCYXNlNjRVcmwgZ2l2ZXMgMjU1IGJ5dGVzLlxuICpcbiAqIE5PVEU6IHRoaXMgaXMgY3VycmVudGx5IG9ubHkgdXNlZCBhcyBhIG1hcmtlciB2YWx1ZSB3aGVuIGNhY2hpbmcgQ2FsZW5kZXJFdmVudCBhbmQgTWFpbFNldEVudHJ5LlxuICovXG5leHBvcnQgY29uc3QgQ1VTVE9NX01BWF9JRCA9IHJlcGVhdChcIl9cIiwgMzQwKVxuZXhwb3J0IGNvbnN0IFJBTkdFX0lURU1fTElNSVQgPSAxMDAwXG5leHBvcnQgY29uc3QgTE9BRF9NVUxUSVBMRV9MSU1JVCA9IDEwMFxuZXhwb3J0IGNvbnN0IFBPU1RfTVVMVElQTEVfTElNSVQgPSAxMDBcblxuLyoqXG4gKiBhbiBlbnRpdHkgdGhhdCBvbmx5IGNvbnRhaW5zIHRoZSBhY3R1YWwgdXNlciBkYXRhIGFuZCBjYW4gbm90IGJlIHVzZWQgdG8gcmVmZXIgdG8gYW55IGV4aXN0aW5nIGVudGl0eS5cbiAqL1xuZXhwb3J0IHR5cGUgU3RyaXBwZWQ8VCBleHRlbmRzIFBhcnRpYWw8U29tZUVudGl0eT4+ID0gT21pdDxcblx0VCxcblx0fCBcIl9pZFwiXG5cdHwgXCJfYXJlYVwiXG5cdHwgXCJfb3duZXJcIlxuXHR8IFwiX293bmVyR3JvdXBcIlxuXHR8IFwiX293bmVyRW5jU2Vzc2lvbktleVwiXG5cdHwgXCJfb3duZXJLZXlWZXJzaW9uXCJcblx0fCBcIl9wZXJtaXNzaW9uc1wiXG5cdHwgXCJfZXJyb3JzXCJcblx0fCBcIl9mb3JtYXRcIlxuXHR8IFwiX3R5cGVcIlxuXHR8IGBfZmluYWxFbmNyeXB0ZWQke3N0cmluZ31gXG5cdHwgYF9kZWZhdWx0RW5jcnlwdGVkJHtzdHJpbmd9YFxuPlxuXG50eXBlIE9wdGlvbmFsRW50aXR5PFQgZXh0ZW5kcyBFbnRpdHk+ID0gVCAmIHtcblx0X2lkPzogSWQgfCBJZFR1cGxlXG5cdF9vd25lckdyb3VwPzogSWRcbn1cblxuZXhwb3J0IHR5cGUgU3RyaXBwZWRFbnRpdHk8VCBleHRlbmRzIEVudGl0eT4gPVxuXHR8IE9taXQ8XG5cdFx0XHRULFxuXHRcdFx0fCBcIl9pZFwiXG5cdFx0XHR8IFwiX293bmVyR3JvdXBcIlxuXHRcdFx0fCBcIl9vd25lckVuY1Nlc3Npb25LZXlcIlxuXHRcdFx0fCBcIl9vd25lcktleVZlcnNpb25cIlxuXHRcdFx0fCBcIl9wZXJtaXNzaW9uc1wiXG5cdFx0XHR8IFwiX2Vycm9yc1wiXG5cdFx0XHR8IFwiX2Zvcm1hdFwiXG5cdFx0XHR8IFwiX3R5cGVcIlxuXHRcdFx0fCBcIl9hcmVhXCJcblx0XHRcdHwgXCJfb3duZXJcIlxuXHRcdFx0fCBgX2ZpbmFsRW5jcnlwdGVkJHtzdHJpbmd9YFxuXHRcdFx0fCBgX2RlZmF1bHRFbmNyeXB0ZWQke3N0cmluZ31gXG5cdCAgPlxuXHR8IE9wdGlvbmFsRW50aXR5PFQ+XG5cbi8qKlxuICogVGVzdHMgaWYgb25lIGlkIGlzIGJpZ2dlciB0aGFuIGFub3RoZXIuXG4gKiBGb3IgZ2VuZXJhdGVkIElEcyB3ZSB1c2UgYmFzZTY0ZXh0IHdoaWNoIGlzIHNvcnRhYmxlLlxuICogRm9yIGN1c3RvbSBJRHMgd2UgdXNlIGJhc2U2NHVybCB3aGljaCBpcyBub3Qgc29ydGFibGUsIHNvIHdlIGNvbnZlcnQgdGhlbSB0byBzdHJpbmcgYmVmb3JlIGNvbXBhcmluZy5cbiAqIEltcG9ydGFudDogdXNpbmcgdGhpcyBmb3IgY3VzdG9tIElEcyB3b3JrcyBvbmx5IHdpdGggY3VzdG9tIElEcyB3aGljaCBhcmUgZGVyaXZlZCBmcm9tIHN0cmluZ3MuXG4gKlxuICogQHBhcmFtIGZpcnN0SWQgVGhlIGVsZW1lbnQgaWQgdGhhdCBpcyB0ZXN0ZWQgaWYgaXQgaXMgYmlnZ2VyLlxuICogQHBhcmFtIHNlY29uZElkIFRoZSBlbGVtZW50IGlkIHRoYXQgaXMgdGVzdGVkIGFnYWluc3QuXG4gKiBAcGFyYW0gdHlwZU1vZGVsIG9wdGlvbmFsIC0gdGhlIHR5cGUgdGhlIElkcyBiZWxvbmcgdG8uIHRoaXMgY2FuIGJlIHVzZWQgdG8gY29tcGFyZSBjdXN0b20gSURzLlxuICogQHJldHVybiBUcnVlIGlmIGZpcnN0SWQgaXMgYmlnZ2VyIHRoYW4gc2Vjb25kSWQsIGZhbHNlIG90aGVyd2lzZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGZpcnN0QmlnZ2VyVGhhblNlY29uZChmaXJzdElkOiBJZCwgc2Vjb25kSWQ6IElkLCB0eXBlTW9kZWw/OiBUeXBlTW9kZWwpOiBib29sZWFuIHtcblx0aWYgKHR5cGVNb2RlbD8udmFsdWVzLl9pZC50eXBlID09PSBWYWx1ZVR5cGUuQ3VzdG9tSWQpIHtcblx0XHRyZXR1cm4gZmlyc3RCaWdnZXJUaGFuU2Vjb25kQ3VzdG9tSWQoZmlyc3RJZCwgc2Vjb25kSWQpXG5cdH0gZWxzZSB7XG5cdFx0Ly8gaWYgdGhlIG51bWJlciBvZiBkaWdpdHMgaXMgYmlnZ2VyLCB0aGVuIHRoZSBpZCBpcyBiaWdnZXIsIG90aGVyd2lzZSB3ZSBjYW4gdXNlIHRoZSBsZXhpY29ncmFwaGljYWwgY29tcGFyaXNvblxuXHRcdGlmIChmaXJzdElkLmxlbmd0aCA+IHNlY29uZElkLmxlbmd0aCkge1xuXHRcdFx0cmV0dXJuIHRydWVcblx0XHR9IGVsc2UgaWYgKHNlY29uZElkLmxlbmd0aCA+IGZpcnN0SWQubGVuZ3RoKSB7XG5cdFx0XHRyZXR1cm4gZmFsc2Vcblx0XHR9IGVsc2Uge1xuXHRcdFx0cmV0dXJuIGZpcnN0SWQgPiBzZWNvbmRJZFxuXHRcdH1cblx0fVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZmlyc3RCaWdnZXJUaGFuU2Vjb25kQ3VzdG9tSWQoZmlyc3RJZDogSWQsIHNlY29uZElkOiBJZCk6IGJvb2xlYW4ge1xuXHRyZXR1cm4gY29tcGFyZShjdXN0b21JZFRvVWludDhhcnJheShmaXJzdElkKSwgY3VzdG9tSWRUb1VpbnQ4YXJyYXkoc2Vjb25kSWQpKSA9PT0gMVxufVxuXG5leHBvcnQgZnVuY3Rpb24gY3VzdG9tSWRUb1VpbnQ4YXJyYXkoaWQ6IElkKTogVWludDhBcnJheSB7XG5cdGlmIChpZCA9PT0gXCJcIikge1xuXHRcdHJldHVybiBuZXcgVWludDhBcnJheSgpXG5cdH1cblx0cmV0dXJuIGJhc2U2NFRvVWludDhBcnJheShiYXNlNjRVcmxUb0Jhc2U2NChpZCkpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjb21wYXJlTmV3ZXN0Rmlyc3QoaWQxOiBJZCB8IElkVHVwbGUsIGlkMjogSWQgfCBJZFR1cGxlKTogbnVtYmVyIHtcblx0bGV0IGZpcnN0SWQgPSBpZDEgaW5zdGFuY2VvZiBBcnJheSA/IGlkMVsxXSA6IGlkMVxuXHRsZXQgc2Vjb25kSWQgPSBpZDIgaW5zdGFuY2VvZiBBcnJheSA/IGlkMlsxXSA6IGlkMlxuXG5cdGlmIChmaXJzdElkID09PSBzZWNvbmRJZCkge1xuXHRcdHJldHVybiAwXG5cdH0gZWxzZSB7XG5cdFx0cmV0dXJuIGZpcnN0QmlnZ2VyVGhhblNlY29uZChmaXJzdElkLCBzZWNvbmRJZCkgPyAtMSA6IDFcblx0fVxufVxuXG5leHBvcnQgZnVuY3Rpb24gY29tcGFyZU9sZGVzdEZpcnN0KGlkMTogSWQgfCBJZFR1cGxlLCBpZDI6IElkIHwgSWRUdXBsZSk6IG51bWJlciB7XG5cdGxldCBmaXJzdElkID0gaWQxIGluc3RhbmNlb2YgQXJyYXkgPyBpZDFbMV0gOiBpZDFcblx0bGV0IHNlY29uZElkID0gaWQyIGluc3RhbmNlb2YgQXJyYXkgPyBpZDJbMV0gOiBpZDJcblxuXHRpZiAoZmlyc3RJZCA9PT0gc2Vjb25kSWQpIHtcblx0XHRyZXR1cm4gMFxuXHR9IGVsc2Uge1xuXHRcdHJldHVybiBmaXJzdEJpZ2dlclRoYW5TZWNvbmQoZmlyc3RJZCwgc2Vjb25kSWQpID8gMSA6IC0xXG5cdH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNvcnRDb21wYXJlQnlSZXZlcnNlSWQ8VCBleHRlbmRzIExpc3RFbGVtZW50PihlbnRpdHkxOiBULCBlbnRpdHkyOiBUKTogbnVtYmVyIHtcblx0cmV0dXJuIGNvbXBhcmVOZXdlc3RGaXJzdChnZXRFbGVtZW50SWQoZW50aXR5MSksIGdldEVsZW1lbnRJZChlbnRpdHkyKSlcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNvcnRDb21wYXJlQnlJZDxUIGV4dGVuZHMgTGlzdEVsZW1lbnQ+KGVudGl0eTE6IFQsIGVudGl0eTI6IFQpOiBudW1iZXIge1xuXHRyZXR1cm4gY29tcGFyZU9sZGVzdEZpcnN0KGdldEVsZW1lbnRJZChlbnRpdHkxKSwgZ2V0RWxlbWVudElkKGVudGl0eTIpKVxufVxuXG4vKipcbiAqIENvbXBhcmVzIHRoZSBpZHMgb2YgdHdvIGVsZW1lbnRzLlxuICogQHByZSBCb3RoIGVudGl0aWVzIGFyZSBlaXRoZXIgRWxlbWVudFR5cGVzIG9yIExpc3RFbGVtZW50VHlwZXNcbiAqIEBwYXJhbSBpZDFcbiAqIEBwYXJhbSBpZDJcbiAqIEByZXR1cm5zIFRydWUgaWYgdGhlIGlkcyBhcmUgdGhlIHNhbWUsIGZhbHNlIG90aGVyd2lzZVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNTYW1lSWQoaWQxOiAoSWQgfCBJZFR1cGxlKSB8IG51bGwsIGlkMjogKElkIHwgSWRUdXBsZSkgfCBudWxsKTogYm9vbGVhbiB7XG5cdGlmIChpZDEgPT09IG51bGwgfHwgaWQyID09PSBudWxsKSB7XG5cdFx0cmV0dXJuIGZhbHNlXG5cdH0gZWxzZSBpZiAoaWQxIGluc3RhbmNlb2YgQXJyYXkgJiYgaWQyIGluc3RhbmNlb2YgQXJyYXkpIHtcblx0XHRyZXR1cm4gaWQxWzBdID09PSBpZDJbMF0gJiYgaWQxWzFdID09PSBpZDJbMV1cblx0fSBlbHNlIHtcblx0XHRyZXR1cm4gaWQxID09PSBpZDJcblx0fVxufVxuXG5leHBvcnQgZnVuY3Rpb24gaGF2ZVNhbWVJZChlbnRpdHkxOiBTb21lRW50aXR5LCBlbnRpdHkyOiBTb21lRW50aXR5KTogYm9vbGVhbiB7XG5cdHJldHVybiBpc1NhbWVJZChlbnRpdHkxLl9pZCwgZW50aXR5Mi5faWQpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjb250YWluc0lkKGlkczogUmVhZG9ubHlBcnJheTxJZCB8IElkVHVwbGU+LCBpZDogSWQgfCBJZFR1cGxlKTogYm9vbGVhbiB7XG5cdHJldHVybiBpZHMuc29tZSgoaWRJbkFycmF5KSA9PiBpc1NhbWVJZChpZEluQXJyYXksIGlkKSlcbn1cblxuZXhwb3J0IGludGVyZmFjZSBFbGVtZW50IHtcblx0X2lkOiBJZFxufVxuXG5leHBvcnQgaW50ZXJmYWNlIExpc3RFbGVtZW50IHtcblx0X2lkOiBJZFR1cGxlXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQmxvYkVsZW1lbnQge1xuXHRfaWQ6IElkVHVwbGVcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEV0SWQoZW50aXR5OiBFbGVtZW50KTogSWQge1xuXHRyZXR1cm4gZW50aXR5Ll9pZFxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0TGV0SWQoZW50aXR5OiBMaXN0RWxlbWVudCk6IElkVHVwbGUge1xuXHRpZiAodHlwZW9mIGVudGl0eS5faWQgPT09IFwidW5kZWZpbmVkXCIpIHtcblx0XHR0aHJvdyBuZXcgRXJyb3IoXCJsaXN0SWQgaXMgbm90IGRlZmluZWQgZm9yIFwiICsgKHR5cGVvZiAoZW50aXR5IGFzIGFueSkuX3R5cGUgPT09IFwidW5kZWZpbmVkXCIgPyBKU09OLnN0cmluZ2lmeShlbnRpdHkpIDogKGVudGl0eSBhcyBhbnkpKSlcblx0fVxuXG5cdHJldHVybiBlbnRpdHkuX2lkXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRFbGVtZW50SWQ8VCBleHRlbmRzIExpc3RFbGVtZW50PihlbnRpdHk6IFQpOiBJZCB7XG5cdHJldHVybiBlbGVtZW50SWRQYXJ0KGdldExldElkKGVudGl0eSkpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRMaXN0SWQ8VCBleHRlbmRzIExpc3RFbGVtZW50PihlbnRpdHk6IFQpOiBJZCB7XG5cdHJldHVybiBsaXN0SWRQYXJ0KGdldExldElkKGVudGl0eSkpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBsaXN0SWRQYXJ0KGlkOiBJZFR1cGxlKTogSWQge1xuXHRyZXR1cm4gaWRbMF1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGVsZW1lbnRJZFBhcnQoaWQ6IElkVHVwbGUpOiBJZCB7XG5cdHJldHVybiBpZFsxXVxufVxuXG4vKipcbiAqIENvbnZlcnRzIGEgc3RyaW5nIHRvIGEgY3VzdG9tIGlkLiBBdHRlbnRpb246IHRoZSBjdXN0b20gaWQgbXVzdCBiZSBpbnRlbmRlZCB0byBiZSBkZXJpdmVkIGZyb20gYSBzdHJpbmcuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzdHJpbmdUb0N1c3RvbUlkKHN0cmluZzogc3RyaW5nKTogc3RyaW5nIHtcblx0cmV0dXJuIHVpbnQ4YXJyYXlUb0N1c3RvbUlkKHN0cmluZ1RvVXRmOFVpbnQ4QXJyYXkoc3RyaW5nKSlcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHVpbnQ4YXJyYXlUb0N1c3RvbUlkKGFycmF5OiBVaW50OEFycmF5KTogc3RyaW5nIHtcblx0cmV0dXJuIGJhc2U2NFRvQmFzZTY0VXJsKHVpbnQ4QXJyYXlUb0Jhc2U2NChhcnJheSkpXG59XG5cbi8qKlxuICogQ29udmVydHMgYSBjdXN0b20gaWQgdG8gYSBzdHJpbmcuIEF0dGVudGlvbjogdGhlIGN1c3RvbSBpZCBtdXN0IGJlIGludGVuZGVkIHRvIGJlIGRlcml2ZWQgZnJvbSBhIHN0cmluZy5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGN1c3RvbUlkVG9TdHJpbmcoY3VzdG9tSWQ6IHN0cmluZyk6IHN0cmluZyB7XG5cdHJldHVybiB1dGY4VWludDhBcnJheVRvU3RyaW5nKGJhc2U2NFRvVWludDhBcnJheShiYXNlNjRVcmxUb0Jhc2U2NChjdXN0b21JZCkpKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlPFQ+KHR5cGVNb2RlbDogVHlwZU1vZGVsLCB0eXBlUmVmOiBUeXBlUmVmPFQ+LCBjcmVhdGVEZWZhdWx0VmFsdWU6IChuYW1lOiBzdHJpbmcsIHZhbHVlOiBNb2RlbFZhbHVlKSA9PiBhbnkgPSBfZ2V0RGVmYXVsdFZhbHVlKTogVCB7XG5cdGxldCBpOiBSZWNvcmQ8c3RyaW5nLCBhbnk+ID0ge1xuXHRcdF90eXBlOiB0eXBlUmVmLFxuXHR9XG5cblx0Zm9yIChsZXQgdmFsdWVOYW1lIG9mIE9iamVjdC5rZXlzKHR5cGVNb2RlbC52YWx1ZXMpKSB7XG5cdFx0bGV0IHZhbHVlID0gdHlwZU1vZGVsLnZhbHVlc1t2YWx1ZU5hbWVdXG5cdFx0aVt2YWx1ZU5hbWVdID0gY3JlYXRlRGVmYXVsdFZhbHVlKHZhbHVlTmFtZSwgdmFsdWUpXG5cdH1cblxuXHRmb3IgKGxldCBhc3NvY2lhdGlvbk5hbWUgb2YgT2JqZWN0LmtleXModHlwZU1vZGVsLmFzc29jaWF0aW9ucykpIHtcblx0XHRsZXQgYXNzb2NpYXRpb24gPSB0eXBlTW9kZWwuYXNzb2NpYXRpb25zW2Fzc29jaWF0aW9uTmFtZV1cblxuXHRcdGlmIChhc3NvY2lhdGlvbi5jYXJkaW5hbGl0eSA9PT0gQ2FyZGluYWxpdHkuQW55KSB7XG5cdFx0XHRpW2Fzc29jaWF0aW9uTmFtZV0gPSBbXVxuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBzZXQgdG8gbnVsbCBldmVuIGlmIHRoZSBjYXJkaW5hbGl0eSBpcyBPbmUuIHdlIGNvdWxkIHRoaW5rIGFib3V0IGNhbGxpbmcgY3JlYXRlIHJlY3Vyc2l2ZWx5LFxuXHRcdFx0Ly8gYnV0IHRoYXQgd291bGQgcmVxdWlyZSB1cyB0byByZXNvbHZlIHR5cGUgcmVmcyAoYXN5bmMpIGFuZCByZWN1cnNpdmVseSBtZXJnZSB0aGUgcmVzdWx0IHdpdGhcblx0XHRcdC8vIHRoZSBwcm92aWRlZCB2YWx1ZXNcblx0XHRcdGlbYXNzb2NpYXRpb25OYW1lXSA9IG51bGxcblx0XHR9XG5cdH1cblxuXHRyZXR1cm4gaSBhcyBhbnlcbn1cblxuZnVuY3Rpb24gX2dldERlZmF1bHRWYWx1ZSh2YWx1ZU5hbWU6IHN0cmluZywgdmFsdWU6IE1vZGVsVmFsdWUpOiBhbnkge1xuXHRpZiAodmFsdWVOYW1lID09PSBcIl9mb3JtYXRcIikge1xuXHRcdHJldHVybiBcIjBcIlxuXHR9IGVsc2UgaWYgKHZhbHVlTmFtZSA9PT0gXCJfaWRcIikge1xuXHRcdHJldHVybiBudWxsIC8vIGFnZ3JlZ2F0ZSBpZHMgYXJlIHNldCBpbiB0aGUgd29ya2VyLCBsaXN0IGlkcyBtdXN0IGJlIHNldCBleHBsaWNpdGVseSBhbmQgZWxlbWVudCBpZHMgYXJlIGNyZWF0ZWQgb24gdGhlIHNlcnZlclxuXHR9IGVsc2UgaWYgKHZhbHVlTmFtZSA9PT0gXCJfcGVybWlzc2lvbnNcIikge1xuXHRcdHJldHVybiBudWxsXG5cdH0gZWxzZSBpZiAodmFsdWUuY2FyZGluYWxpdHkgPT09IENhcmRpbmFsaXR5Llplcm9Pck9uZSkge1xuXHRcdHJldHVybiBudWxsXG5cdH0gZWxzZSB7XG5cdFx0c3dpdGNoICh2YWx1ZS50eXBlKSB7XG5cdFx0XHRjYXNlIFZhbHVlVHlwZS5CeXRlczpcblx0XHRcdFx0cmV0dXJuIG5ldyBVaW50OEFycmF5KDApXG5cblx0XHRcdGNhc2UgVmFsdWVUeXBlLkRhdGU6XG5cdFx0XHRcdHJldHVybiBuZXcgRGF0ZSgpXG5cblx0XHRcdGNhc2UgVmFsdWVUeXBlLk51bWJlcjpcblx0XHRcdFx0cmV0dXJuIFwiMFwiXG5cblx0XHRcdGNhc2UgVmFsdWVUeXBlLlN0cmluZzpcblx0XHRcdFx0cmV0dXJuIFwiXCJcblxuXHRcdFx0Y2FzZSBWYWx1ZVR5cGUuQm9vbGVhbjpcblx0XHRcdFx0cmV0dXJuIGZhbHNlXG5cblx0XHRcdGNhc2UgVmFsdWVUeXBlLkN1c3RvbUlkOlxuXHRcdFx0Y2FzZSBWYWx1ZVR5cGUuR2VuZXJhdGVkSWQ6XG5cdFx0XHRcdHJldHVybiBudWxsXG5cdFx0XHQvLyB3ZSBoYXZlIHRvIHVzZSBudWxsIGFsdGhvdWdoIHRoZSB2YWx1ZSBtdXN0IGJlIHNldCB0byBzb21ldGhpbmcgZGlmZmVyZW50XG5cdFx0fVxuXHR9XG5cblx0dGhyb3cgbmV3IEVycm9yKGBubyBkZWZhdWx0IHZhbHVlIGZvciAke0pTT04uc3RyaW5naWZ5KHZhbHVlKX1gKVxufVxuXG4vKipcbiAqIENvbnZlcnRzIGEgdGltZXN0YW1wIG51bWJlciB0byBhIEdlbmVyYXRlZElkICh0aGUgY291bnRlciBpcyBzZXQgdG8gemVybykgaW4gaGV4IGZvcm1hdC5cbiAqXG4gKiBAcGFyYW0gdGltZXN0YW1wIFRoZSB0aW1lc3RhbXAgb2YgdGhlIEdlbmVyYXRlZElkXG4gKiBAcmV0dXJuIFRoZSBHZW5lcmF0ZWRJZCBhcyBoZXggc3RyaW5nLlxuICovXG5leHBvcnQgZnVuY3Rpb24gdGltZXN0YW1wVG9IZXhHZW5lcmF0ZWRJZCh0aW1lc3RhbXA6IG51bWJlciwgc2VydmVyQnl0ZXM6IG51bWJlcik6IEhleCB7XG5cdGxldCBpZCA9IHRpbWVzdGFtcCAqIDQgLy8gc2hpZnRlZCAyIGJpdHMgbGVmdCwgc28gdGhlIHZhbHVlIGNvdmVycyA0NCBiaXRzIG92ZXJhbGwgKDQyIHRpbWVzdGFtcCArIDIgc2hpZnRlZClcblxuXHRsZXQgaGV4ID0gaWQudG9TdHJpbmcoMTYpICsgXCIwMDAwMFwiICsgcGFkKHNlcnZlckJ5dGVzLCAyKSAvLyBhZGQgb25lIHplcm8gZm9yIHRoZSBtaXNzaW5nIDQgYml0cyBwbHVzIDQgbW9yZSAoMiBieXRlcykgcGx1cyAyIG1vcmUgZm9yIHRoZSBzZXJ2ZXIgaWQgdG8gZ2V0IDkgYnl0ZXNcblxuXHQvLyBhZGQgbGVhZGluZyB6ZXJvcyB0byByZWFjaCA5IGJ5dGVzIChHZW5lcmF0ZWRJZCBsZW5ndGgpID0gMTggaGV4XG5cdGZvciAobGV0IGxlbmd0aCA9IGhleC5sZW5ndGg7IGxlbmd0aCA8IDE4OyBsZW5ndGgrKykge1xuXHRcdGhleCA9IFwiMFwiICsgaGV4XG5cdH1cblxuXHRyZXR1cm4gaGV4XG59XG5cbi8qKlxuICogQ29udmVydHMgYSB0aW1lc3RhbXAgbnVtYmVyIHRvIGEgR2VuZXJhdGVkSWQgKHRoZSBjb3VudGVyIGFuZCBzZXJ2ZXIgYml0cyBhcmUgc2V0IHRvIHplcm8pLlxuICpcbiAqIEBwYXJhbSB0aW1lc3RhbXAgVGhlIHRpbWVzdGFtcCBvZiB0aGUgR2VuZXJhdGVkSWRcbiAqIEByZXR1cm4gVGhlIEdlbmVyYXRlZElkLlxuICovXG5leHBvcnQgZnVuY3Rpb24gdGltZXN0YW1wVG9HZW5lcmF0ZWRJZCh0aW1lc3RhbXA6IG51bWJlciwgc2VydmVyQnl0ZXM6IG51bWJlciA9IDApOiBJZCB7XG5cdGxldCBoZXggPSB0aW1lc3RhbXBUb0hleEdlbmVyYXRlZElkKHRpbWVzdGFtcCwgc2VydmVyQnl0ZXMpXG5cdHJldHVybiBiYXNlNjRUb0Jhc2U2NEV4dChoZXhUb0Jhc2U2NChoZXgpKVxufVxuXG4vKipcbiAqIEV4dHJhY3RzIHRoZSB0aW1lc3RhbXAgZnJvbSBhIEdlbmVyYXRlZElkXG4gKiBAcGFyYW0gYmFzZTY0RXh0IFRoZSBpZCBhcyBiYXNlNjRFeHRcbiAqIEByZXR1cm5zIFRoZSB0aW1lc3RhbXAgb2YgdGhlIEdlbmVyYXRlZElkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZWRJZFRvVGltZXN0YW1wKGJhc2U2NEV4dDogSWQpOiBudW1iZXIge1xuXHRjb25zdCBiYXNlNjQgPSBiYXNlNjRFeHRUb0Jhc2U2NChiYXNlNjRFeHQpXG5cdGNvbnN0IGRlY29kZWRiQjQgPSBhdG9iKGJhc2U2NClcblx0bGV0IG51bWJlclJlc3VsdCA9IDBcblxuXHQvLyBUaW1lc3RhbXAgaXMgaW4gdGhlIGZpcnN0IDQyIGJpdHNcblx0Zm9yIChsZXQgaSA9IDA7IGkgPCA1OyBpKyspIHtcblx0XHQvLyBXZSBcInNoaWZ0XCIgZWFjaCBudW1iZXIgYnkgOCBiaXRzIHRvIHRoZSBsZWZ0OiBudW1iZXJSZXN1bHQgPDwgOFxuXHRcdG51bWJlclJlc3VsdCA9IG51bWJlclJlc3VsdCAqIDI1NlxuXHRcdG51bWJlclJlc3VsdCArPSBkZWNvZGVkYkI0LmNoYXJDb2RlQXQoaSlcblx0fVxuXG5cdC8vIFdlIG5lZWQgdG8gc2hpZnQgdGhlIHdob2xlIG51bWJlciB0byB0aGUgbGVmdCBieSAyIGJpdHMgKGJlY2F1c2UgNDIgYml0cyBpcyBlbmNvZGVkIGluIDYgYnl0ZXMpXG5cdG51bWJlclJlc3VsdCA9IG51bWJlclJlc3VsdCAqIDRcblx0Ly8gV2UgdGFrZSBvbmx5IGxhc3QgdHdvIGhpZ2hlc3QgYml0cyBmcm9tIHRoZSBsYXN0IGJ5dGVcblx0bnVtYmVyUmVzdWx0ICs9IGRlY29kZWRiQjQuY2hhckNvZGVBdCg1KSA+Pj4gNlxuXHRyZXR1cm4gbnVtYmVyUmVzdWx0XG59XG5cbmNvbnN0IGJhc2U2NGV4dEVuY29kZWRJZExlbmd0aCA9IEdFTkVSQVRFRF9NQVhfSUQubGVuZ3RoXG5jb25zdCBiYXNlNjRleHRBbHBoYWJldCA9IFwiLTAxMjM0NTY3ODlBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWl9hYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5elwiXG5cbmV4cG9ydCBmdW5jdGlvbiBpc1ZhbGlkR2VuZXJhdGVkSWQoaWQ6IElkIHwgSWRUdXBsZSk6IGJvb2xlYW4ge1xuXHRjb25zdCB0ZXN0ID0gKGlkOiBzdHJpbmcpID0+IGlkLmxlbmd0aCA9PT0gYmFzZTY0ZXh0RW5jb2RlZElkTGVuZ3RoICYmIEFycmF5LmZyb20oaWQpLmV2ZXJ5KChjaGFyKSA9PiBiYXNlNjRleHRBbHBoYWJldC5pbmNsdWRlcyhjaGFyKSlcblxuXHRyZXR1cm4gdHlwZW9mIGlkID09PSBcInN0cmluZ1wiID8gdGVzdChpZCkgOiBpZC5ldmVyeSh0ZXN0KVxufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNFbGVtZW50RW50aXR5KGU6IFNvbWVFbnRpdHkpOiBlIGlzIEVsZW1lbnRFbnRpdHkge1xuXHRyZXR1cm4gdHlwZW9mIGUuX2lkID09PSBcInN0cmluZ1wiXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBhc3NlcnRJc0VudGl0eTxUIGV4dGVuZHMgU29tZUVudGl0eT4oZW50aXR5OiBTb21lRW50aXR5LCB0eXBlOiBUeXBlUmVmPFQ+KTogZW50aXR5IGlzIFQge1xuXHRpZiAoaXNTYW1lVHlwZVJlZihlbnRpdHkuX3R5cGUsIHR5cGUpKSB7XG5cdFx0cmV0dXJuIHRydWVcblx0fSBlbHNlIHtcblx0XHRyZXR1cm4gZmFsc2Vcblx0fVxufVxuXG5leHBvcnQgZnVuY3Rpb24gYXNzZXJ0SXNFbnRpdHkyPFQgZXh0ZW5kcyBTb21lRW50aXR5Pih0eXBlOiBUeXBlUmVmPFQ+KTogKGVudGl0eTogU29tZUVudGl0eSkgPT4gZW50aXR5IGlzIFQge1xuXHRyZXR1cm4gKGUpOiBlIGlzIFQgPT4gYXNzZXJ0SXNFbnRpdHkoZSwgdHlwZSlcbn1cblxuLyoqXG4gKiBSZW1vdmUgc29tZSBoaWRkZW4gdGVjaG5pY2FsIGZpZWxkcyBmcm9tIHRoZSBlbnRpdHkuXG4gKlxuICogT25seSB1c2UgZm9yIG5ldyBlbnRpdGllcywgdGhlIHtAcGFyYW0gZW50aXR5fSB3b24ndCBiZSB1c2FibGUgZm9yIHVwZGF0ZXMgYW55bW9yZSBhZnRlciB0aGlzLlxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVtb3ZlVGVjaG5pY2FsRmllbGRzPEUgZXh0ZW5kcyBQYXJ0aWFsPFNvbWVFbnRpdHk+PihlbnRpdHk6IEUpIHtcblx0Ly8gd2Ugd2FudCB0byByZXN0cmljdCBvdXRlciBmdW5jdGlvbiB0byBlbnRpdHkgdHlwZXMgYnV0IGludGVybmFsbHkgd2UgYWxzbyB3YW50IHRvIGhhbmRsZSBhZ2dyZWdhdGVzXG5cdGZ1bmN0aW9uIF9yZW1vdmVUZWNobmljYWxGaWVsZHMoZXJhc2VkOiBSZWNvcmQ8c3RyaW5nLCBhbnk+KSB7XG5cdFx0Zm9yIChjb25zdCBrZXkgb2YgT2JqZWN0LmtleXMoZXJhc2VkKSkge1xuXHRcdFx0aWYgKGtleS5zdGFydHNXaXRoKFwiX2ZpbmFsRW5jcnlwdGVkXCIpIHx8IGtleS5zdGFydHNXaXRoKFwiX2RlZmF1bHRFbmNyeXB0ZWRcIikgfHwga2V5LnN0YXJ0c1dpdGgoXCJfZXJyb3JzXCIpKSB7XG5cdFx0XHRcdGRlbGV0ZSBlcmFzZWRba2V5XVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Y29uc3QgdmFsdWUgPSBlcmFzZWRba2V5XVxuXHRcdFx0XHRpZiAodmFsdWUgaW5zdGFuY2VvZiBPYmplY3QpIHtcblx0XHRcdFx0XHRfcmVtb3ZlVGVjaG5pY2FsRmllbGRzKHZhbHVlKVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0X3JlbW92ZVRlY2huaWNhbEZpZWxkcyhlbnRpdHkpXG59XG5cbi8qKlxuICogZ2V0IGEgY2xvbmUgb2YgYSAocGFydGlhbCkgZW50aXR5IHRoYXQgZG9lcyBub3QgY29udGFpbiBhbnkgZmllbGRzIHRoYXQgd291bGQgaW5kaWNhdGUgdGhhdCBpdCB3YXMgZXZlciBwZXJzaXN0ZWQgYW55d2hlcmUuXG4gKiBAcGFyYW0gZW50aXR5IHRoZSBlbnRpdHkgdG8gc3RyaXBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFN0cmlwcGVkQ2xvbmU8RSBleHRlbmRzIFNvbWVFbnRpdHk+KGVudGl0eTogU3RyaXBwZWRFbnRpdHk8RT4pOiBTdHJpcHBlZEVudGl0eTxFPiB7XG5cdGNvbnN0IGNsb25lZCA9IGNsb25lKGVudGl0eSlcblx0cmVtb3ZlVGVjaG5pY2FsRmllbGRzKGNsb25lZClcblx0cmVtb3ZlSWRlbnRpdHlGaWVsZHMoY2xvbmVkKVxuXHRyZXR1cm4gY2xvbmVkXG59XG5cbi8qKlxuICogcmVtb3ZlIGZpZWxkcyB0aGF0IGRvIG5vdCBjb250YWluIHVzZXIgZGVmaW5lZCBkYXRhIGJ1dCBhcmUgcmVsYXRlZCB0byBmaW5kaW5nL2FjY2Vzc2luZyB0aGUgZW50aXR5IG9uIHRoZSBzZXJ2ZXJcbiAqL1xuZnVuY3Rpb24gcmVtb3ZlSWRlbnRpdHlGaWVsZHM8RSBleHRlbmRzIFBhcnRpYWw8U29tZUVudGl0eT4+KGVudGl0eTogRSkge1xuXHRjb25zdCBrZXlzVG9EZWxldGUgPSBbXCJfaWRcIiwgXCJfb3duZXJHcm91cFwiLCBcIl9vd25lckVuY1Nlc3Npb25LZXlcIiwgXCJfb3duZXJLZXlWZXJzaW9uXCIsIFwiX3Blcm1pc3Npb25zXCJdXG5cblx0ZnVuY3Rpb24gX3JlbW92ZUlkZW50aXR5RmllbGRzKGVyYXNlZDogUmVjb3JkPHN0cmluZywgYW55Pikge1xuXHRcdGZvciAoY29uc3Qga2V5IG9mIE9iamVjdC5rZXlzKGVyYXNlZCkpIHtcblx0XHRcdGlmIChrZXlzVG9EZWxldGUuaW5jbHVkZXMoa2V5KSkge1xuXHRcdFx0XHRkZWxldGUgZXJhc2VkW2tleV1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGNvbnN0IHZhbHVlID0gZXJhc2VkW2tleV1cblx0XHRcdFx0aWYgKHZhbHVlIGluc3RhbmNlb2YgT2JqZWN0KSB7XG5cdFx0XHRcdFx0X3JlbW92ZUlkZW50aXR5RmllbGRzKHZhbHVlKVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0X3JlbW92ZUlkZW50aXR5RmllbGRzKGVudGl0eSlcbn1cblxuLyoqIGNvbnN0cnVjdCBhIG1haWwgc2V0IGVudHJ5IElkIGZvciBhIGdpdmVuIG1haWwuIHNlZSBNYWlsRm9sZGVySGVscGVyLmphdmEgKi9cbmV4cG9ydCBmdW5jdGlvbiBjb25zdHJ1Y3RNYWlsU2V0RW50cnlJZChyZWNlaXZlRGF0ZTogRGF0ZSwgbWFpbElkOiBJZCk6IElkIHtcblx0Y29uc3QgYnVmZmVyID0gbmV3IERhdGFWaWV3KG5ldyBBcnJheUJ1ZmZlcihNQUlMX1NFVF9FTlRSWV9JRF9CWVRFX0xFTkdUSCkpXG5cdGNvbnN0IG1haWxJZEJ5dGVzID0gYmFzZTY0VG9VaW50OEFycmF5KGJhc2U2NEV4dFRvQmFzZTY0KG1haWxJZCkpXG5cblx0Ly8gc2hpZnRpbmcgdGhlIHJlY2VpdmVkIHRpbWVzdGFtcCBieSAxMCBiaXQgcmVkdWNlcyB0aGUgcmVzb2x1dGlvbiBmcm9tIDFtcyB0byAxMDI0bXMuXG5cdC8vIHRydW5jYXRpbmcgdG8gNCBieXRlcyBsZWF2ZXMgdXMgd2l0aCBlbm91Z2ggc3BhY2UgZm9yIGVwb2NoICsgNF8yOTRfOTY3XzI5NSBub3QtcXVpdGUtc2Vjb25kc1xuXHQvLyAodW50aWwgYXJvdW5kIDIxMDktMDUtMTUgMTU6MDApXG5cdGNvbnN0IHRpbWVzdGFtcDogYmlnaW50ID0gQmlnSW50KE1hdGgudHJ1bmMocmVjZWl2ZURhdGUuZ2V0VGltZSgpKSlcblxuXHRjb25zdCB0cnVuY2F0ZWRSZWNlaXZlRGF0ZSA9ICh0aW1lc3RhbXAgPj4gMTBuKSAmIDB4MDAwMDAwMDBmZmZmZmZmZm5cblxuXHQvLyB3ZSBkb24ndCBuZWVkIHRoZSBsZWFkaW5nIHplcm9lc1xuXHRidWZmZXIuc2V0QmlnVWludDY0KDAsIHRydW5jYXRlZFJlY2VpdmVEYXRlIDw8IDMybilcblxuXHRmb3IgKGxldCBpID0gMDsgaSA8IG1haWxJZEJ5dGVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0YnVmZmVyLnNldFVpbnQ4KGkgKyA0LCBtYWlsSWRCeXRlc1tpXSlcblx0fVxuXG5cdHJldHVybiB1aW50OGFycmF5VG9DdXN0b21JZChuZXcgVWludDhBcnJheShidWZmZXIuYnVmZmVyKSlcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRlY29uc3RydWN0TWFpbFNldEVudHJ5SWQoaWQ6IElkKTogeyByZWNlaXZlRGF0ZTogRGF0ZTsgbWFpbElkOiBJZCB9IHtcblx0Y29uc3QgYnVmZmVyID0gY3VzdG9tSWRUb1VpbnQ4YXJyYXkoaWQpXG5cdGNvbnN0IHRpbWVzdGFtcEJ5dGVzID0gYnVmZmVyLnNsaWNlKDAsIDQpXG5cdGNvbnN0IGdlbmVyYXRlZElkQnl0ZXMgPSBidWZmZXIuc2xpY2UoNClcblxuXHRjb25zdCB0aW1lc3RhbXAxMDI0ID0gKHRpbWVzdGFtcEJ5dGVzWzBdIDw8IDI0KSB8ICh0aW1lc3RhbXBCeXRlc1sxXSA8PCAxNikgfCAodGltZXN0YW1wQnl0ZXNbMl0gPDwgOCkgfCB0aW1lc3RhbXBCeXRlc1szXVxuXHRjb25zdCB0aW1lc3RhbXAgPSB0aW1lc3RhbXAxMDI0ICogMTAyNFxuXG5cdGNvbnN0IG1haWxJZCA9IGJhc2U2NFRvQmFzZTY0RXh0KHVpbnQ4QXJyYXlUb0Jhc2U2NChnZW5lcmF0ZWRJZEJ5dGVzKSlcblxuXHRyZXR1cm4geyByZWNlaXZlRGF0ZTogbmV3IERhdGUodGltZXN0YW1wKSwgbWFpbElkIH1cbn1cblxuZXhwb3J0IGNvbnN0IExFR0FDWV9UT19SRUNJUElFTlRTX0lEID0gMTEyXG5leHBvcnQgY29uc3QgTEVHQUNZX0NDX1JFQ0lQSUVOVFNfSUQgPSAxMTNcbmV4cG9ydCBjb25zdCBMRUdBQ1lfQkNDX1JFQ0lQSUVOVFNfSUQgPSAxMTRcbmV4cG9ydCBjb25zdCBMRUdBQ1lfQk9EWV9JRCA9IDExNlxuIl0sIm1hcHBpbmdzIjoiOzs7TUFFYSxPQUFPLE9BQU8sT0FBTztDQUNqQyxTQUFTO0NBQ1QsYUFBYTtDQUNiLGNBQWM7Q0FDZCxZQUFZO0NBQ1osYUFBYTtBQUNiLEVBQUM7TUFFVyxjQUFjLE9BQU8sT0FBTztDQUN4QyxXQUFXO0NBQ1gsS0FBSztDQUNMLEtBQUs7QUFDTCxFQUFDO01BRVcsa0JBQWtCLE9BQU8sT0FBTztDQUM1QyxvQkFBb0I7Q0FDcEIsaUJBQWlCO0NBQ2pCLGlDQUFpQztDQUNqQyxhQUFhO0NBQ2Isd0JBQXdCO0NBQ3hCLDhCQUE4QjtBQUM5QixFQUFDO01BRVcsWUFBWSxPQUFPLE9BQU87Q0FDdEMsUUFBUTtDQUNSLFFBQVE7Q0FDUixPQUFPO0NBQ1AsTUFBTTtDQUNOLFNBQVM7Q0FDVCxhQUFhO0NBQ2IsVUFBVTtDQUNWLGtCQUFrQjtBQUNsQixFQUFDO01BRVcsZUFBZSxPQUFPLE9BQU87Q0FDekMsYUFBYTtDQUNiLFNBQVM7QUFDVCxFQUFDOzs7O01DZlcsbUJBQW1CO01BUW5CLGdEQUFnRCxJQUFJLEtBQUsscUJBQXFCLFNBQVM7TUFLdkYsbUJBQW1CO01BS25CLDRC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